<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>AVERAGEIF function</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p>LibreOffice 7.3 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" onclick="setupModules('en-US');">Module</button><nav id="modules-nav"></nav>
</div></div></header><aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  🔎︎ </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search" placeholder="Search in chosen module"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">
<a name="averageif_function"></a>
<a name="bm_id19444137534261"></a>
<a name="bm_id237812197829662"></a>
  <meta itemprop="keywords" content="AVERAGEIF function">
  <meta itemprop="keywords" content="arithmetic mean,satisfying condition">

<h2 id="hd_id16852304621982">
<a name="averageif_head"></a>AVERAGEIF function</h2>
<p id="par_id7281266615152" class="paragraph"><span class="avis"><a name="averageif_des"></a>Returns the arithmetic mean of all cells in a range that satisfy a given condition. The AVERAGEIF function sums up all the results that match the logical test and divides this sum by the quantity of selected values.</span></p>

<div class="embedded">
<a name="4.0"></a>
        <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id651551401041640">This function is available since LibreOffice 4.0.</p></div>
</div>
<br>
    </div>
<div class="embedded">
<a name="sectionsyntax"></a>
        <h4 id="hd_id3152015">Syntax</h4>
    </div>
<p id="par_id200801176228491" class="code">AVERAGEIF(Range; Criterion [; Average_Range ])</p>
<p id="par_id15226321619829" class="paragraph"><span class="emph">Range</span> – required argument. An array, a name of named range or a label of a column or a row containing numbers for averaging or numbers or text for the condition.</p>
<div class="embedded">
<a name="criterion"></a>
        <p id="par_id621619279022341" class="paragraph"><span class="emph">Criterion</span>: A criterion is a single cell Reference, Number or Text. It is used in comparisons with cell contents.</p>
        <p id="par_id731619279029255" class="paragraph">A reference to an empty cell is interpreted as the numeric value 0.</p>
        <p id="par_id31619279035359" class="paragraph">A matching expression can be:</p>
        <ul itemprop="Unordered" itemscope="true" itemtype="http://schema.org/ItemList">
            <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
                <p id="par_id171619279059462" class="listitem">A Number or Logical value. A matching cell content equals the Number or Logical value. </p>
            </li>
            <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
                <p id="par_id511619279076504" class="listitem">A value beginning with a comparator (&lt;, &lt;=, =, &gt;, &gt;=, &lt;&gt;).</p>
                <p id="par_id11619279168512" class="paragraph">For =, if the value is empty it matches empty cells.</p>
                <p id="par_id161619279207350" class="paragraph">For &lt;&gt;, if the value is empty it matches non-empty cells.</p>
                <p id="par_id271619279215695" class="paragraph">For &lt;&gt;, if the value is not empty it matches any cell content except the value, including empty cells.</p>
                <p id="par_id861619279223855" class="paragraph"><span class="emph">Note:</span> "=0" does not match empty cells.</p>
                <p id="par_id51619279363954" class="paragraph">For = and &lt;&gt;, if the value is not empty and can not be interpreted as a Number type or one of its subtypes and the property <a target="_top" href="en-US/text/shared/optionen/01060500.html">Search criteria = and &lt;&gt; must apply to whole cells</a> is checked, comparison is against the entire cell contents, if unchecked, comparison is against any subpart of the field that matches the criteria. For = and &lt;&gt;, if the value is not empty and can not be interpreted as a Number type or one of its subtypes applies. </p>
            </li>
            <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
                <p id="par_id801619279323556" class="listitem">Other Text value. If the property <a target="_top" href="en-US/text/shared/optionen/01060500.html">Search criteria = and &lt;&gt; must apply to whole cells</a> is true, the comparison is against the entire cell contents, if false, comparison is against any subpart of the field that matches the criteria. The expression can contain text, numbers, regular expressions or wildcards (<a target="_top" href="en-US/text/shared/optionen/01060500.html#wildcards">if enabled in calculation options</a>).</p>
            </li>
        </ul>
    </div>
<div class="embedded">
<a name="regex"></a>
    <p id="par_id3147418" class="paragraph">The search supports wildcards or <a target="_top" href="en-US/text/shared/01/02100001.html">regular expressions</a>. With regular expressions enabled, you can enter "all.*", for example to find the first location of "all" followed by any characters. If you want to search for a text that is also a regular expression, you must either precede every character with a "\" character, or enclose the text into \Q...\E. You can switch the automatic evaluation of wildcards or regular expression on and off in <a target="_top" href="en-US/text/shared/optionen/01060500.html"><span id="swlnsystextshared0000000001xml_3" class="switchinline"><span hidden="true" id="MACtextshared0000000001xml_3" class="MAC"><span class="menuitem">LibreOffice - Preferences</span></span><span hidden="true" id="defaulttextshared0000000001xml_3"><span class="menuitem">Tools - Options</span></span></span><span class="menuitem"> - LibreOffice Calc - Calculate</span></a>.</p>
    <a name="regexnumex"></a>
        <div class="warning">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" title="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id651572973288601">When using functions where one or more arguments are search criteria strings that represents a regular expression, the first attempt is to convert the string criteria to numbers. For example, ".0" will convert to 0.0 and so on. If successful, the match will not be a regular expression match but a numeric match. However, when switching to a locale where the decimal separator is not the dot makes the regular expression conversion work. To force the evaluation of the regular expression instead of a numeric expression, use some expression that can not be misread as numeric, such as ".[0]" or ".\0" or "(?i).0". </p></div>
</div>
<br>
    
</div>
<p id="par_id174711913219765" class="paragraph"><span class="emph">Average_Range</span> – optional. It is a range of values for calculating the mean.</p>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" title="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id45123108916423">If the <span class="emph">Average_Range</span> is not specified, <span class="emph">Range</span> is used for both, the calculation of the mean and the search according to the condition. If  <span class="emph">Average_Range</span> is specified, the <span class="emph">Range</span> is used only for the condition test, while <span class="emph">Average_Range</span> is used for the average calculation.</p></div>
</div>
<br>
<div class="embedded">
<a name="odff"></a>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" title="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="hd_id1000010">This function is part of the Open Document Format for Office Applications (OpenDocument) standard Version 1.2. (ISO/IEC 26300:2-2015)</p></div>
</div>
<br>
</div>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" title="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id278275053653">If a cell in a range of values for calculating the mean is empty or contains text, function AVERAGEIF ignores this cell.<br>
If the whole range is empty, contains only text or all values of the range do not satisfy the condition (or any combination of those), the function returns the #DIV/0! error. </p></div>
</div>
<br>
<div class="embedded">
<a name="ex_func_average"></a>
<div class="embedded">
<a name="sectionexample"></a>
        <h4 id="hd_id281171">Example</h4>
    </div>
<p id="hd_id2609201512474295" class="paragraph">Consider the following table</p>
<table border="1" class="" cellpadding="0" cellspacing="0">
  <tr>
    <td rowspan="" colspan="">
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201517430799" class="tableheadintable">A</p>
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id250920151743116" class="tableheadintable">B</p>
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201517431582" class="tableheadintable">C</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201517431967" class="tableheadintable">1</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id18260631312423" class="tablecontentintable">Product Name</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201517433075" class="tablecontentintable">Sales</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519383294" class="tablecontentintable">Revenue</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id959660094035" class="tableheadintable">2</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2855779586764" class="tablecontentintable">pencil</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id110202156219769" class="tablecontentintable">20</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id23281929326512" class="tablecontentintable">65</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201517432278" class="tableheadintable">3</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id24967262611733" class="tablecontentintable">pen</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201517433391" class="tablecontentintable">35</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id250920151938352" class="tablecontentintable">85</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id250920151743267" class="tableheadintable">4</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id252542413030532" class="tablecontentintable">notebook</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201517433781" class="tablecontentintable">20</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519383822" class="tablecontentintable">190</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201519371339" class="tableheadintable">5</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519374677" class="tablecontentintable">book</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519373350" class="tablecontentintable">17</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519384171" class="tablecontentintable">180</p>
    </td>
  </tr>
    <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id6009596127912" class="tableheadintable">6</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id19479417931163" class="tablecontentintable">pencil-case</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id85353130721737" class="tablecontentintable">not</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id15693941827291" class="tablecontentintable">not</p>
    </td>
  </tr>
</table>
<br>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" title="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id1191767622119">In all examples below, ranges for calculation contain the row #6, which is ignored because it contains text.</p></div>
</div>
<br>
</div>
<h4 id="hd_id229513120314273">Simple usage</h4>
<p id="par_id2509201519225446" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;35")</span></p>
<p id="par_id11322891219251" class="paragraph">Calculates the average for values of the range B2:B6 that are less than 35. Returns 19, because the second row does not participate in the calculation.</p>
<p id="par_id250920151922590" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;"&amp;MAX(B2:B6))</span></p>
<p id="par_id3813266131474" class="paragraph">Calculates the average for values of the same range that are less than the maximum value of this range. Returns 19, because the largest value (the second row) does not participate in the calculation.</p>
<p id="par_id2509201519230832" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&gt;"&amp;SMALL(B2:B6;1))</span></p>
<p id="par_id243522732832394" class="paragraph">Calculates the average for values of the same range that are greater than the first smallest value of this range. Returns 25, because the first smallest value (the fourth row) does not participate in the calculation.</p>
<h4 id="hd_id2101254257133">Using the Average_Range</h4>
<p id="par_id2509201519315584" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;35";C2:C6)</span></p>
<p id="par_id148222637631350" class="paragraph">The function searches what values are less than 35 in the B2:B6 range, and calculates the average of corresponding values from the C2:C6 range. Returns 145, because the second row does not participate in the calculation. </p>
<p id="par_id2509201519315535" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&gt;"&amp;MIN(B2:B6);C2:C6)</span></p>
<p id="par_id2412836525208" class="paragraph">The function searches what values from the range B2:B6 are greater than the least value in the B2:B6 range, and calculates the average of corresponding values from the C2:C6 range. Returns 113.3, because the fourth row (where there is the least value in the range B2:B6) does not participate in the calculation.</p>
<p id="par_id2509201519315547" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;"&amp;LARGE(B2:B6;2);C2:C6)</span></p>
<p id="par_id173931101529497" class="paragraph">The function searches what values from the range B2:B6 are less than the second large value in the B2:B6 range, and calculates the average of corresponding values from the C2:C6 range. Returns 180, because only the fourth row participates in the calculation. </p>
<h4 id="hd_id30054471316969">Using regular expressions</h4>
<p id="par_id2509201519360514" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(A2:A6;"pen";B2:B6)</span></p>
<p id="par_id14714860719948" class="paragraph">The function searches what cells from the range A2:A6 contain only the word “pen”, and calculates the average of corresponding values from the B2:B6 range. Returns 35, because only the second row participates in the calculation. The search is performed in the A2:A6 range, but the values are returned from the B2:B6 range.</p>
<p id="par_id250920151936096" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(A2:A6;"pen.*";B2:B6)</span></p>
<p id="par_id26959239098104" class="paragraph">The function searches what cells from the range A2:A6 begin with “pen” ending with any quantity of other characters, and calculates the average of corresponding values from the B2:B6 range. Returns 27.5, because now also “pencil” satisfies the condition, and both, first and second rows participate in the calculation. </p>
<p id="par_id2509201519361352" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(A2:A6;".*book.*";B2:B6)</span></p>
<p id="par_id227041304619482" class="paragraph">The function searches what cells from the range A2:A6 contain “book” starting and ending with any quantity of other characters, and calculates the average of corresponding values from the B2:B6 range. Returns 18.5, because only third and fourth rows participate in the calculation.</p>
<h4 id="hd_id251309885188">Reference to a cell as a criterion</h4>
<p id="par_id177972099720424" class="paragraph">If you need to change a criterion easily, you may want to specify it in a separate cell and use a reference to this cell in the condition of AVERAGEIF function. </p>
<p id="par_id134941261230060" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(A2:A6;".*"&amp;E2&amp;".*";B2:B6)</span></p>
<p id="par_id172572288310247" class="paragraph">The function searches what cells from the range A2:A6 contain a combination of characters specified in E2 starting and ending with any quantity of other characters, and calculates the average of corresponding values from the B2:B6 range. If E2 = book, the function returns 18.5.</p>
<p id="par_id316901523627285" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AVERAGEIF(B2:B6;"&lt;"&amp;E2;C2:C6)</span></p>
<p id="par_id302181300528607" class="paragraph">The function searches what cells from the range B2:B6 are less than the value specified in E2, and calculates the average of corresponding values from the C2:C6 range. If E2 = 35, the function returns 145.</p>
<a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
    <p id="par_id11921178730928" class="paragraph">
        <a name="average_head"></a><a target="_top" href="en-US/text/scalc/01/04060184.html#average">AVERAGE</a>,
        <a name="averagea_head"></a><a target="_top" href="en-US/text/scalc/01/04060184.html#averagea">AVERAGEA</a>,
        <a name="avedev_head"></a><a target="_top" href="en-US/text/scalc/01/04060184.html#avedev">AVEDEV</a>
    </p>
    <p id="par_id11931178730928" class="paragraph">
        <a name="countifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_countifs.html">COUNTIFS</a>,
        <a name="minifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_minifs.html">MINIFS</a>,
        <a name="maxifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_maxifs.html">MAXIFS</a>,
        <a name="averageifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_averageifs.html">AVERAGEIFS</a>,
        <a name="sumifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_sumifs.html">SUMIFS</a>
    </p>
<p id="par_id251321802714497" class="paragraph"><a name="02100001"></a><a target="_top" href="en-US/text/shared/01/02100001.html">List of Regular Expressions</a></p>
</div>
</div>
</div>
<div id="SearchFrame"></div>
<div id="DonationFrame"></div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/scalc/01/func_averageif.xhp" target="_blank">/text/scalc/01/func_averageif.xhp</a></p>
<p>Title is: AVERAGEIF function</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
<p id="bm_HID"></p>
</div></footer>
</body>
</html>
