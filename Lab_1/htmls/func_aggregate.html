<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>AGGREGATE function</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p>LibreOffice 7.3 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" onclick="setupModules('en-US');">Module</button><nav id="modules-nav"></nav>
</div></div></header><aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  🔎︎ </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search" placeholder="Search in chosen module"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">
<a name="aggregate_function"></a>
<a name="bm_id13660154375100"></a>
<a name="bm_id126123001625791"></a>
  <meta itemprop="keywords" content="AGGREGATE function">

<h1 id="hd_id3154073">
<a name="aggregate_head"></a>AGGREGATE function</h1>
<p id="par_id2209201514174373" class="paragraph"><span class="avis"><a name="aggregate_des"></a>This function returns an aggregate result of the calculations in the range. You can use different aggregate functions listed below. The Aggregate function enables you to omit hidden rows, errors, SUBTOTAL and other AGGREGATE function results in the calculation.</span></p>

<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="Note Icon 
" title="Note Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p>AGGREGATE function is applied to vertical ranges of data with activated AutoFilter. If AutoFilter is not activated, automatic recalculation of the function result does not work for newly hidden rows. It is not supposed to work with horizontal ranges, however it can be applied to them as well, but with limitations. In particular, the AGGREGATE function applied to a horizontal data range does not recognize hiding columns, however correctly omits errors and results of SUBTOTAL and other AGGREGATE functions embedded into the row. </p></div>
</div>
<br>
<div class="embedded">
<a name="4.4"></a>
        <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id651551401041644">This function is available since LibreOffice 4.4.</p></div>
</div>
<br>
    </div>
<div class="embedded">
<a name="sectionsyntax"></a>
        <h4 id="hd_id3152015">Syntax</h4>
    </div>

<p id="par_id200801176228491" class="code">AGGREGATE(Function; Option; Number 1[; Number 2][; ... ;[Number 253]])</p>
<p id="par_id2309201516102726" class="paragraph">or</p>
<p id="par_id30181907128680" class="code">AGGREGATE(Function; Option; Array[; k])</p>

<p id="par_id2209201514174378" class="paragraph"><span class="emph">Function</span> – obligatory argument. A function index or a reference to a cell with value from 1 to 19, in accordance with the following table. </p>

<table border="1" class="" cellpadding="0" cellspacing="0">
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201511454963" class="tableheadintable">Function index</p>
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201511454945" class="tableheadintable">Function applied</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360097" class="tablecontentintable">1</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360043" class="paragraphintable">AVERAGE</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360099" class="tablecontentintable">2</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id230920151136007" class="paragraphintable">COUNT</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360027" class="tablecontentintable">3</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360018" class="paragraphintable">COUNTA</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id230920151136004" class="tablecontentintable">4</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360026" class="paragraphintable">MAX</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360080" class="tablecontentintable">5</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360078" class="paragraphintable">MIN</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360031" class="tablecontentintable">6</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360087" class="paragraphintable">PRODUCT</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360175" class="tablecontentintable">7</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360153" class="paragraphintable">STDEV.S</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id255902101420976" class="tablecontentintable">8</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360178" class="paragraphintable">STDEV.P</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360158" class="tablecontentintable">9</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360199" class="paragraphintable">SUM</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id29935318632937" class="tablecontentintable">10</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360174" class="paragraphintable">VAR.S</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360133" class="tablecontentintable">11</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360120" class="paragraphintable">VAR.P</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360171" class="tablecontentintable">12</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360122" class="paragraphintable">MEDIAN</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360111" class="tablecontentintable">13</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id230920151136016" class="paragraphintable">MODE.SNGL</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360130" class="tablecontentintable">14</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360180" class="paragraphintable">LARGE</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360116" class="tablecontentintable">15</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360150" class="paragraphintable">SMALL</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360132" class="tablecontentintable">16</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360157" class="paragraphintable">PERCENTILE.INC </p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360155" class="tablecontentintable">17</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360151" class="paragraphintable">QUARTILE.INC</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360162" class="tablecontentintable">18</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id230920151136017" class="paragraphintable">PERCENTILE.EXC</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360141" class="tablecontentintable">19</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201511360169" class="paragraphintable">QUARTILE.EXC</p>
    </td>
  </tr>
</table>
<br>

<p id="par_id2209201514174372" class="paragraph"><span class="emph">Option</span> – obligatory argument. An option index or reference to a cell with value from 0 to 7 determines what to ignore in the range for the function.</p>

<table border="1" class="" cellpadding="0" cellspacing="0">
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201512011557" class="tableheadintable">Option index</p>
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201512011551" class="tableheadintable">Option applied</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011582" class="tablecontentintable">0</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011567" class="tablecontentintable">Ignore only nested SUBTOTAL and AGGREGATE functions </p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011554" class="tablecontentintable">1</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id315771547630277" class="tablecontentintable">Ignore only hidden rows, nested SUBTOTAL and AGGREGATE functions </p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011521" class="tablecontentintable">2</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011514" class="tablecontentintable">Ignore only errors, nested SUBTOTAL and AGGREGATE functions </p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011568" class="tablecontentintable">3</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011547" class="tablecontentintable">Ignore hidden rows, errors, nested SUBTOTAL and AGGREGATE functions</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011515" class="tablecontentintable">4</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011510" class="tablecontentintable">Ignore nothing</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011558" class="tablecontentintable">5</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011592" class="tablecontentintable">Ignore only hidden rows</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011524" class="tablecontentintable">6</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id230920151201150" class="tablecontentintable">Ignore only errors</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011519" class="tablecontentintable">7</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201512011539" class="tablecontentintable">Ignore only hidden rows and errors</p>
    </td>
  </tr>
</table>
<br>

<p id="par_id220402843321947" class="paragraph"><span class="emph">Number1</span> – required argument. The first numeric argument (if the range is set by a list of values inside the function) or a reference to a cell that contains it. </p>
<p id="par_id2309201514193338" class="paragraph"><span class="emph">Number2, 3, ...</span> – optional. A numeric argument or a reference to a cell (up to 253 arguments), for which you need the aggregate value.</p>
<p id="par_id99381371214702" class="paragraph"><span class="emph">Array</span> – required argument. The array can be specified by the boundaries of the range, the name of the named range or the column label.</p>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="Note Icon 
" title="Note Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p>For using column labels “Automatically find columns and rows labels” function needs to be enabled.</p></div>
</div>
<br>
<p id="par_id2209201514174370" class="paragraph"><span class="emph">k</span> – required argument for the following functions: LARGE, SMALL, PERCENTILE.INC, QUARTILE.INC, PERCENTILE.EXC, QUARTILE.EXC. It is a numeric argument, which must correspond to the second argument of these functions.</p>

<div class="embedded">
<a name="sectionexample"></a>
        <h4 id="hd_id281171">Example</h4>
    </div>

<table border="1" class="" cellpadding="0" cellspacing="0">
  <tr>
    <td rowspan="" colspan="">
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201517365893" class="tableheadintable">A</p>
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201517370258" class="tableheadintable">B</p>
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201517370634" class="tableheadintable">C</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518440896" class="tableheadintable">1</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201518454314" class="tablecontentintable"><span class="emph">ColumnOne</span></p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201518454361" class="tablecontentintable"><span class="emph">ColumnTwo</span></p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201518454323" class="tablecontentintable"><span class="emph">ColumnThree</span></p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518441431" class="tableheadintable">2</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id230920151737158" class="tablecontentintable">34</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id230920151737193" class="tablecontentintable">11</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id230920151737237" class="tablecontentintable">12</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518441863" class="tableheadintable">3</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id230920151737314" class="tablecontentintable">10</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517373578" class="tablecontentintable">56</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517373986" class="tablecontentintable">35</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518442333" class="tableheadintable">4</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id27530261624700" class="tablecontentintable">#DIV/0!</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517383112" class="tablecontentintable">5</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517384053" class="tablecontentintable">3</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518442714" class="tableheadintable">5</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517381443" class="tablecontentintable">20</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517384793" class="tablecontentintable">8</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517384332" class="tablecontentintable">1</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518443189" class="tableheadintable">6</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517381714" class="tablecontentintable">0</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517385044" class="tablecontentintable">8</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517390378" class="tablecontentintable">9</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518443420" class="tableheadintable">7</p>
    </td>
    <td rowspan="" colspan="">
      <p id="id_par29987248418152" class="tablecontentintable">#VALUE!</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517385358" class="tablecontentintable">20</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517391077" class="tablecontentintable">21</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518443714" class="tableheadintable">8</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517382160" class="tablecontentintable">5</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517385765" class="tablecontentintable">7</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517391385" class="tablecontentintable">8</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2309201518444120" class="tableheadintable">9</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517382451" class="tablecontentintable">14</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517390082" class="tablecontentintable">0</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2309201517391680" class="tablecontentintable">5</p>
    </td>
  </tr>
</table>
<br>

<p id="par_id230920152006414" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AGGREGATE(4;2;A2:A9)</span><br>Returns maximum value for the range A2:A9 = 34, whereas <span class="input" data-tooltip="Click on text to copy to clipboard">=MAX(A2:A9)</span> returns the error Err:511.</p>
<p id="par_id2309201520064180" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AGGREGATE(9;5;A5:C5)</span><br>Returns sum for the range A5:C5 = 29, even if some of the columns are hidden.</p>
<p id="par_id2309201520064118" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AGGREGATE(9;5;B2:B9)</span><br>Returns sum of the column B = 115. If any row is hidden, the function omit its value, for example if the 7th row is hidden, the function returns 95.</p>
<p id="par_id196152404026557" class="paragraph">If you need to apply the function with a 3D range, this example shows how to do it.</p>
<p id="par_id2309201520180167" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AGGREGATE(13;3;Sheet1.B2:B9:Sheet3.B2:B9)</span><br>The function returns mode of the values of second columns through sheets 1:3 (that have the same data) = 8.</p>
<p id="par_id2309201520395365" class="paragraph">You can use reference to a cell or a range for every argument in the formula. The following example shows how it works. Besides, it shows that you can use column labels to specify an array.</p>
<p id="par_id2309201520395380" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=AGGREGATE(E3;E5;'ColumnOne')</span><br>If E3 = 13 and E5 = 5, the function returns mode of the first column = 10.</p>

<a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
<p id="par_id241712879431120" class="paragraph"><a target="_top" href="en-US/text/scalc/01/04060184.html#average">AVERAGE</a>, <a target="_top" href="en-US/text/scalc/01/04060181.html#count">COUNT</a>, <a target="_top" href="en-US/text/scalc/01/04060181.html#counta">COUNTA</a>, <a target="_top" href="en-US/text/scalc/01/04060184.html#max">MAX</a>, <a target="_top" href="en-US/text/scalc/01/04060184.html#min">MIN</a>, <a target="_top" href="en-US/text/scalc/01/04060106.html#Section26">PRODUCT</a>, <a target="_top" href="en-US/text/scalc/01/04060185.html#stdevdots">STDEV.S</a>, <a target="_top" href="en-US/text/scalc/01/04060185.html#stdevdotp">STDEV.P</a>, <a target="_top" href="en-US/text/scalc/01/04060106.html#Section16">SUM</a>, <a target="_top" href="en-US/text/scalc/01/04060185.html#vardots">VAR.S</a>, <a target="_top" href="en-US/text/scalc/01/04060185.html#vardotp">VAR.P</a>, <a target="_top" href="en-US/text/scalc/01/04060184.html#median">MEDIAN</a>, <a target="_top" href="en-US/text/scalc/01/04060184.html#modedotsngl">MODE.SNGL</a>, <a target="_top" href="en-US/text/scalc/01/04060183.html#large">LARGE</a>, <a target="_top" href="en-US/text/scalc/01/04060183.html#small">SMALL</a>, <a target="_top" href="en-US/text/scalc/01/04060184.html#percentileinc">PERCENTILE.INC</a> , <a target="_top" href="en-US/text/scalc/01/04060184.html#quartileinc">QUARTILE.INC</a>, <a target="_top" href="en-US/text/scalc/01/04060184.html#percentileexc">PERCENTILE.EXC</a>, <a target="_top" href="en-US/text/scalc/01/04060184.html#quartileexc">QUARTILE.EXC</a></p>
<p id="par_id125062615028497" class="paragraph"><a target="_top" href="en-US/text/shared/optionen/01060500.html#hd_id3156199">Automatically find column and row labels</a></p>
</div>
</div>
</div>
<div id="SearchFrame"></div>
<div id="DonationFrame"></div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/scalc/01/func_aggregate.xhp" target="_blank">/text/scalc/01/func_aggregate.xhp</a></p>
<p>Title is: AGGREGATE function</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
<p id="bm_HID"></p>
</div></footer>
</body>
</html>
