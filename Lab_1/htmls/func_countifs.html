<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>COUNTIFS function</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p>LibreOffice 7.3 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" onclick="setupModules('en-US');">Module</button><nav id="modules-nav"></nav>
</div></div></header><aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search" placeholder="Search in chosen module"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">
<a name="countifs_function"></a>
<a name="bm_id449544954495"></a>
<a name="bm_id452245224522"></a>
  <meta itemprop="keywords" content="COUNTIFS function">
  <meta itemprop="keywords" content="counting row,satisfying criteria">
  <meta itemprop="keywords" content="counting column,satisfying criteria">

<h1 id="hd_id456845684568">
<a name="countifs_head"></a>COUNTIFS</h1>
<p id="par_id462646264626" class="paragraph"><span class="avis"><a name="countifs_des"></a>Returns the count of cells that meet criteria in multiple ranges.</span></p>

<div class="embedded">
<a name="4.0"></a>
        <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id651551401041640">This function is available since LibreOffice 4.0.</p></div>
</div>
<br>
    </div>
<div class="embedded">
<a name="sectionsyntax"></a>
        <h4 id="hd_id3152015">Syntax</h4>
    </div>

<p id="par_id27421466710275" class="code">COUNTIFS(Range; Criterion[; Range2; Criterion2][; ... ; [Range127; Criterion127]])</p>
<div class="embedded">
<a name="par00"></a>
    <p id="par_id101585468691583" class="paragraph"><span class="emph">Range1</span> â€“ required argument. It is a range of cells, a name of a named range, or a label of a column or a row, to which the corresponding criterion is to be applied.</p>
        <a name="criterion"></a>
        <p id="par_id621619279022341" class="paragraph"><span class="emph">Criterion</span>: A criterion is a single cell Reference, Number or Text. It is used in comparisons with cell contents.</p>
        <p id="par_id731619279029255" class="paragraph">A reference to an empty cell is interpreted as the numeric value 0.</p>
        <p id="par_id31619279035359" class="paragraph">A matching expression can be:</p>
        <ul itemprop="Unordered" itemscope="true" itemtype="http://schema.org/ItemList">
            <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
                <p id="par_id171619279059462" class="listitem">A Number or Logical value. A matching cell content equals the Number or Logical value. </p>
            </li>
            <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
                <p id="par_id511619279076504" class="listitem">A value beginning with a comparator (&lt;, &lt;=, =, &gt;, &gt;=, &lt;&gt;).</p>
                <p id="par_id11619279168512" class="paragraph">For =, if the value is empty it matches empty cells.</p>
                <p id="par_id161619279207350" class="paragraph">For &lt;&gt;, if the value is empty it matches non-empty cells.</p>
                <p id="par_id271619279215695" class="paragraph">For &lt;&gt;, if the value is not empty it matches any cell content except the value, including empty cells.</p>
                <p id="par_id861619279223855" class="paragraph"><span class="emph">Note:</span> "=0" does not match empty cells.</p>
                <p id="par_id51619279363954" class="paragraph">For = and &lt;&gt;, if the value is not empty and can not be interpreted as a Number type or one of its subtypes and the property <a target="_top" href="en-US/text/shared/optionen/01060500.html">Search criteria = and &lt;&gt; must apply to whole cells</a> is checked, comparison is against the entire cell contents, if unchecked, comparison is against any subpart of the field that matches the criteria. For = and &lt;&gt;, if the value is not empty and can not be interpreted as a Number type or one of its subtypes applies. </p>
            </li>
            <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
                <p id="par_id801619279323556" class="listitem">Other Text value. If the property <a target="_top" href="en-US/text/shared/optionen/01060500.html">Search criteria = and &lt;&gt; must apply to whole cells</a> is true, the comparison is against the entire cell contents, if false, comparison is against any subpart of the field that matches the criteria. The expression can contain text, numbers, regular expressions or wildcards (<a target="_top" href="en-US/text/shared/optionen/01060500.html#wildcards">if enabled in calculation options</a>).</p>
            </li>
        </ul>
    
    <p id="par_id190621657742" class="paragraph"><span class="emph">Range2</span> â€“ Optional. Range2 and all the following mean the same as Range1.</p>
    <p id="par_id317001803813193" class="paragraph"><span class="emph">Criterion2</span> â€“ Optional. Criterion2 and all the following mean the same as Criterion.</p>
</div>
<div class="embedded">
<a name="regex"></a>
    <p id="par_id3147418" class="paragraph">The search supports wildcards or <a target="_top" href="en-US/text/shared/01/02100001.html">regular expressions</a>. With regular expressions enabled, you can enter "all.*", for example to find the first location of "all" followed by any characters. If you want to search for a text that is also a regular expression, you must either precede every character with a "\" character, or enclose the text into \Q...\E. You can switch the automatic evaluation of wildcards or regular expression on and off in <a target="_top" href="en-US/text/shared/optionen/01060500.html"><span id="swlnsystextshared0000000001xml_3" class="switchinline"><span hidden="true" id="MACtextshared0000000001xml_3" class="MAC"><span class="menuitem">LibreOffice - Preferences</span></span><span hidden="true" id="defaulttextshared0000000001xml_3"><span class="menuitem">Tools - Options</span></span></span><span class="menuitem"> - LibreOffice Calc - Calculate</span></a>.</p>
    <a name="regexnumex"></a>
        <div class="warning">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" title="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id651572973288601">When using functions where one or more arguments are search criteria strings that represents a regular expression, the first attempt is to convert the string criteria to numbers. For example, ".0" will convert to 0.0 and so on. If successful, the match will not be a regular expression match but a numeric match. However, when switching to a locale where the decimal separator is not the dot makes the regular expression conversion work. To force the evaluation of the regular expression instead of a numeric expression, use some expression that can not be misread as numeric, such as ".[0]" or ".\0" or "(?i).0". </p></div>
</div>
<br>
    
</div>
<p id="par_id14734320631377" class="paragraph"><span class="emph">Range, Range2, ...</span> and <span class="emph">Criterion, Criterion2, ...</span> must have the same size, otherwise the function returns err:502 - Invalid argument.</p>
<div class="embedded">
<a name="note01"></a>
    <div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" title="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id94162948227556">The logical relation between criteria can be defined as logical AND (conjunction). In other words, if and only if all given criteria are met, a value from the corresponding cell of the given <span class="emph">Func_Range</span> is taken into calculation.</p></div>
</div>
<br>
</div>
<div class="embedded">
<a name="par01"></a>
    <p id="par_id191527781733238" class="paragraph">The function can have up to 255 arguments, meaning that you can specify 127 criteria ranges and criteria for them.</p>
    <p id="par_id175721789527973" class="paragraph">If a cell contains TRUE, it is treated as 1, if a cell contains FALSE â€“ as 0 (zero).</p>
</div>
<div class="embedded">
<a name="odff"></a>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" title="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="hd_id1000010">This function is part of the Open Document Format for Office Applications (OpenDocument) standard Version 1.2. (ISO/IEC 26300:2-2015)</p></div>
</div>
<br>
</div>
<div class="embedded">
<a name="ex_func_average"></a>
<div class="embedded">
<a name="sectionexample"></a>
        <h4 id="hd_id281171">Example</h4>
    </div>
<p id="hd_id2609201512474295" class="paragraph">Consider the following table</p>
<table border="1" class="" cellpadding="0" cellspacing="0">
  <tr>
    <td rowspan="" colspan="">
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201517430799" class="tableheadintable">A</p>
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id250920151743116" class="tableheadintable">B</p>
    </td>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201517431582" class="tableheadintable">C</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201517431967" class="tableheadintable">1</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id18260631312423" class="tablecontentintable">Product Name</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201517433075" class="tablecontentintable">Sales</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519383294" class="tablecontentintable">Revenue</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id959660094035" class="tableheadintable">2</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2855779586764" class="tablecontentintable">pencil</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id110202156219769" class="tablecontentintable">20</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id23281929326512" class="tablecontentintable">65</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201517432278" class="tableheadintable">3</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id24967262611733" class="tablecontentintable">pen</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201517433391" class="tablecontentintable">35</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id250920151938352" class="tablecontentintable">85</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id250920151743267" class="tableheadintable">4</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id252542413030532" class="tablecontentintable">notebook</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201517433781" class="tablecontentintable">20</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519383822" class="tablecontentintable">190</p>
    </td>
  </tr>
  <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id2509201519371339" class="tableheadintable">5</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519374677" class="tablecontentintable">book</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519373350" class="tablecontentintable">17</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id2509201519384171" class="tablecontentintable">180</p>
    </td>
  </tr>
    <tr>
    <td rowspan="" colspan="" class="tableheadcell">
      <p id="par_id6009596127912" class="tableheadintable">6</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id19479417931163" class="tablecontentintable">pencil-case</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id85353130721737" class="tablecontentintable">not</p>
    </td>
    <td rowspan="" colspan="">
      <p id="par_id15693941827291" class="tablecontentintable">not</p>
    </td>
  </tr>
</table>
<br>
<div class="warning">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" title="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id1191767622119">In all examples below, ranges for calculation contain the row #6, which is ignored because it contains text.</p></div>
</div>
<br>
</div>
<h4 id="hd_id3861259759512">Simple usage</h4>
<p id="par_id15856592423333" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(B2:B6;"&gt;=20")</span></p>
<p id="par_id323511393121175" class="paragraph">Counts the amount of rows of the range B2:B6 with values greater than or equal to 20. Returns 3, because the fifth and the sixth rows do not meet the criterion.</p>
<p id="par_id74301057922522" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(B2:B6;"&gt;=20";C2:C6;"&gt;70")</span></p>
<p id="par_id109622995127628" class="paragraph">Counts the amount of rows that contain simultaneously values greater than 70 in the C2:C6 range and values greater than or equal to 20 in the B2:B6 range. Returns 2, because the second, the fifth and the sixth rows do not meet at least one criterion.</p>
<h4 id="hd_id298462825526166">Using regular expressions and nested functions</h4>
<p id="par_id831605805755075" class="paragraph">For these examples to work as described, make sure that <span class="emph">Enable regular expressions in formulas</span> is selected in <span id="swlnsystextscalc01func_countifsxml_1" class="switchinline"><span hidden="true" id="MACtextscalc01func_countifsxml_1" class="MAC"><span class="menuitem">LibreOffice - Preferences</span></span><span hidden="true" id="defaulttextscalc01func_countifsxml_1"><span class="menuitem">Tools - Options</span></span></span><span class="menuitem"> - LibreOffice Calc - Calculate</span>.</p>
<p id="par_id22736248573471" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(B2:B6;"[:alpha:]*")</span></p>
<p id="par_id22137303324873" class="paragraph">Counts the amount of rows of the B2:B6 range that contain only alphabet symbols. Returns 1, because only sixth row meets the criterion.</p>
<p id="par_id82271340221411" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(B2:B6;"&gt;"&amp;MIN(B2:B6);B2:B6;"&lt;"&amp;MAX(B2:B6))</span></p>
<p id="par_id1105320769334" class="paragraph">Counts the amount of rows of the B2:B6 range excluding rows with minimum and maximum values of this range. Returns 2, because the third, the fifth and the sixth rows do not meet at least one criterion.</p>
<p id="par_id267603146513224" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(A2:A6;"pen.*";B2:B6;"&lt;"&amp;MAX(B2:B6))</span></p>
<p id="par_id111252614832220" class="paragraph">Counts the amount of rows that correspond to all cells of the A2:A6 range starting with "pen" and to all cells of the B2:B6 range with exception of its maximum. Returns 1, because only second row meets all criteria.</p>
<h4 id="hd_id212582362610399">Reference to a cell as a criterion</h4>
<p id="par_id3245551524846" class="paragraph">If you need to change a criterion easily, you may want to specify it in a separate cell and use a reference to this cell in the condition of the COUNTIFS function. For example, the above function can be rewritten as follows:</p>
<p id="par_id109501907712434" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">=COUNTIFS(A2:A6;E2&amp;".*";B2:B6;"&lt;"&amp;MAX(B2:B6))</span></p>
<p id="par_id738533068520" class="paragraph">If E2 = pen, the function returns 1, because the link to the cell is substituted with its content and it works as a function above.</p>
<div class="embedded">
<a name="func_ifs"></a>
        <p id="par_id721528312694192" class="paragraph"></p>
    </div>
<a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
    <p id="par_id11921178730928" class="paragraph">
        <a name="count_head"></a><a target="_top" href="en-US/text/scalc/01/04060181.html#count">COUNT</a>,
        <a name="countif_head"></a><a target="_top" href="en-US/text/scalc/01/04060181.html#countif">COUNTIF</a>,
        <a name="countblank_head"></a><a target="_top" href="en-US/text/scalc/01/04060181.html#countblank">COUNTBLANK</a>,
        <a name="counta_head"></a><a target="_top" href="en-US/text/scalc/01/04060181.html#counta">COUNTA</a>
    </p>
    <p id="par_id11931178730928" class="paragraph">
        <a name="countifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_countifs.html">COUNTIFS</a>,
        <a name="minifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_minifs.html">MINIFS</a>,
        <a name="maxifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_maxifs.html">MAXIFS</a>,
        <a name="averageifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_averageifs.html">AVERAGEIFS</a>,
        <a name="sumifs_head"></a><a target="_top" href="en-US/text/scalc/01/func_sumifs.html">SUMIFS</a>
    </p>
<p id="par_id235992404316585" class="paragraph"><a name="02100001"></a><a target="_top" href="en-US/text/shared/01/02100001.html">List of Regular Expressions</a></p>
</div>
</div>
</div>
<div id="SearchFrame"></div>
<div id="DonationFrame"></div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/scalc/01/func_countifs.xhp" target="_blank">/text/scalc/01/func_countifs.xhp</a></p>
<p>Title is: COUNTIFS function</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
<p id="bm_HID"></p>
</div></footer>
</body>
</html>
