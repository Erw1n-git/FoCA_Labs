<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SFDatabases.Database service</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p>LibreOffice 7.3 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" onclick="setupModules('en-US');">Module</button><nav id="modules-nav"></nav>
</div></div></header><aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search" placeholder="Search in chosen module"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">
<a name="ScriptForge-sf_database"></a>
   <a name="bm_id151587913266190"></a>
      <meta itemprop="keywords" content="Database service">
   


<a name="abstract"></a>
    <h1 id="hd_id371587913266310">
<a name="DatabaseService"></a><span class="literal">SFDatabases</span>.<span class="literal">Database</span> service</h1>
    <p id="par_id891599407198144" class="paragraph">The <span class="literal">Database</span> service provides access to databases either embedded or described in Base documents. This service provides methods to:</p>
    <ul itemprop="Unordered" itemscope="true" itemtype="http://schema.org/ItemList">
      <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
        <p id="par_id551615386924481" class="listitem">Get access to data in database tables.</p>
      </li>
      <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
        <p id="par_id551615386924285" class="listitem">Run <span class="literal">SELECT</span> queries and perform aggregate functions.</p>
      </li>
      <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
        <p id="par_id551615386924111" class="listitem">Run SQL action statements such as <span class="literal">INSERT</span>, <span class="literal">UPDATE</span>, <span class="literal">DELETE</span>, etc.</p>
      </li>
    </ul>

    <p id="par_id811599407236602" class="paragraph">Each instance of the <span class="literal">Database</span> service represents a single database and gives access to its tables, queries and data.</p>
    <p id="par_id111625692871642" class="paragraph">This service does not provide access to forms or reports in the Base document that contains the database. To access forms in a Base document, refer to the method <a target="_top" href="en-US/text/sbasic/shared/03/sf_base.html#FormDocuments"><span class="literal">FormDocuments</span></a> of the <span class="literal">Base</span> service.</p>
    <div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" title="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id231615386789950">All exchanges between this service and the database are done using SQL only.</p></div>
</div>
<br>
    <p id="par_id121599407322804" class="paragraph">SQL statements may be run in <span class="emph">direct</span> or <span class="emph">indirect</span> mode. In direct mode the statement is transferred to the database engine without any syntax checking or review.</p>
    <p id="par_id681599407189019" class="paragraph">The provided interfaces include simple tables and queries lists, as well as access to database data.</p>
    <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id891599407280007">To make SQL statements more readable, you may use square brackets "[ ]" to enclose names of tables, queries and fields instead of using other enclosing characters that may be exclusive to certain Relational Database Management Systems (RDBMS). But beware that enclosing characters are mandatory in this context.</p></div>
</div>
<br>

    <h2 id="hd_id91587913266988">Service invocation</h2>
    <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682">
<a name="functsyntax"></a>Syntax:</h3>
</div>
    <p id="par_id541599408159668" class="paragraph">To create a instance of the <span class="literal">Database</span> service you can use the <span class="literal">CreateScriptService</span> method:</p>
    <p id="par_id251625693098616" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">CreateScriptService("SFDatabases.Database", [filename: str], [registrationname], [readonly], [user, [password]]): svc</span>
    </p>
    <div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" title="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id551625693442959">In the syntax described above you can use either "SFDatabases.Database" or simply "Database" as the first argument of the <span class="literal">CreateScriptService</span> method.</p></div>
</div>
<br>
    <div class="embedded">
<a name="functparameters"></a>
<h3 id="hd_id061420171139084157">
<a name="functparameters"></a>Parameters:</h3>
</div>
    <p id="par_id111615146818256" class="paragraph"><span class="emph">filename</span>: The name of the Base file. Must be expressed using <span class="literal">SF_FileSystem.FileNaming</span> notation.</p>
    <p id="par_id771615146944307" class="paragraph"><span class="emph">registrationname</span>: The name of a registered database. If <span class="literal">filename</span> is provided, this argument should not be used.</p>
    <p id="par_id491615147048748" class="paragraph">Conversely, if a <span class="literal">registrationname</span> is specified, the <span class="literal">filename</span> parameter should not be defined.</p>
    <p id="par_id841615147168279" class="paragraph"><span class="emph">readonly</span>: Determines if the database will be opened as readonly (Default = <span class="literal">True</span>).</p>
    <p id="par_id291615147236001" class="paragraph"><span class="emph">user, password</span>: Additional connection parameters to the database server.</p>
    <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233">
<a name="functexample"></a>Example:</h3>
</div>
    <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501">In Basic</h5>
</div>
    <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
      GlobalScope.BasicLibraries.LoadLibrary("ScriptForge")
      Dim myDatabase as Object
      Set myDatabase = CreateScriptService("Database", "/home/user/Documents/myDB.odb")
      ' Run queries, SQL statements, ...
      myDatabase.CloseDatabase()
    </code></pre></div>
    <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993">In Python</h5>
</div>
    <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
      from scriptforge import CreateScriptService
      myDatabase = CreateScriptService("Database", "/home/user/Documents/myDB.odb")
      # Run queries, SQL statements, ...
      myDatabase.CloseDatabase()
    </code></pre></div>

    <h2 id="hd_id771615147491563">Accessing Databases with the UI Service</h2>
    <p id="par_id901599408410712" class="paragraph">It is also possible to access the database associated with a Base document using the <a target="_top" href="en-US/text/sbasic/shared/03/sf_ui.html"><span class="literal">ScriptForge.UI</span></a> service, as shown in the examples below:</p>
    <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501">In Basic</h5>
</div>
    <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
      Dim myDoc As Object, myDatabase As Object, ui As Object
      Set ui = CreateScriptService("UI")
      Set myDoc = ui.OpenBaseDocument("/home/user/Documents/myDB.odb")
      ' User and password are supplied below, if needed
      Set myDatabase = myDoc.GetDatabase()
      ' Run queries, SQL statements, ...
      myDatabase.CloseDatabase()
      myDoc.CloseDocument()
    </code></pre></div>
    <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993">In Python</h5>
</div>
    <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
      ui = CreateScriptService("UI")
      doc = ui.OpenBaseDocument("/home/user/Documents/myDB.odb")
      # User and password are supplied below, if needed
      myDatabase = doc.GetDatabase()
      # Run queries, SQL statements, ...
      myDatabase.CloseDatabase()
      doc.CloseDocument()
    </code></pre></div>
    <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id361619188184750">The <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#GetDatabase">GetDatabase</a> method used in the example above is part of ScriptForge's <span class="literal">Base</span> service.</p></div>
</div>
<br>

    <a name="bm_id771615387442357"></a>
        <meta itemprop="keywords" content="Database Service,Queries">
        <meta itemprop="keywords" content="Database Service,Tables">
    
    <h2 id="hd_id841587913266618">Properties</h2>
    <table border="1" class="" cellpadding="0" cellspacing="0">
      <tr>
          <td rowspan="" colspan="" class="tableheadcell">
              <p id="par_id521587913266568" class="tableheadintable">Name</p>
          </td>
          <td rowspan="" colspan="" class="tableheadcell">
              <p id="par_id421587913266368" class="tableheadintable">Readonly</p>
          </td>
          <td rowspan="" colspan="" class="tableheadcell">
              <p id="par_id631587914939732" class="tableheadintable">Type</p>
              </td>
          <td rowspan="" colspan="" class="tableheadcell">
              <p id="par_id951587913266220" class="tableheadintable">Description</p>
          </td>
      </tr>
      <tr>
          <td rowspan="" colspan="">
              <p id="par_id161587913266162" class="tablecontentintable">Queries</p>
          </td>
          <td rowspan="" colspan="">
              <p id="par_id651587913266754" class="tablecontentintable">Yes</p>
          </td>
          <td rowspan="" colspan="">
              <p id="par_id421587914989890" class="tablecontentintable">Array of strings</p>
              </td>
          <td rowspan="" colspan="">
              <p id="par_id351587913266349" class="tablecontentintable">The list of stored queries.</p>
          </td>
      </tr>
      <tr>
          <td rowspan="" colspan="">
              <p id="par_id851599409717318" class="tablecontentintable">Tables</p>
          </td>
          <td rowspan="" colspan="">
              <p id="par_id931599409717463" class="tablecontentintable">Yes</p>
          </td>
          <td rowspan="" colspan="">
              <p id="par_id71599409717945" class="tablecontentintable">Array of strings</p>
          </td>
          <td rowspan="" colspan="">
              <p id="par_id341599409717612" class="tablecontentintable">The list of stored tables.</p>
          </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="par_id561599409777730" class="tablecontentintable">XConnection</p>
            </td>
            <td rowspan="" colspan="">
                <p id="par_id741599409777967" class="tablecontentintable">Yes</p>
            </td>
            <td rowspan="" colspan="">
                <p id="par_id101599409777906" class="tablecontentintable"><a target="_blank" href="https://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1sdbc_1_1XConnection.html">XConnection</a></p>
            </td>
            <td rowspan="" colspan="">
                <p id="par_id551599409777759" class="tablecontentintable">The UNO object representing the current database connection.</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="par_id361599409887831" class="tablecontentintable">XMetaData</p>
            </td>
            <td rowspan="" colspan="">
                <p id="par_id271599409887585" class="tablecontentintable">Yes</p>
            </td>
            <td rowspan="" colspan="">
                <p id="par_id701599409887579" class="tablecontentintable"><a target="_blank" href="https://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1sdbc_1_1XDatabaseMetaData.html">XDatabaseMetaData</a></p>
            </td>
            <td rowspan="" colspan="">
                <p id="par_id861599409887284" class="tablecontentintable">The UNO object representing the metadata describing the database system attributes.</p>
            </td>
        </tr>
    </table>
<br>

<table border="1" class="" cellpadding="0" cellspacing="0">
   <tr>
       <td rowspan="" colspan="3" class="tableheadcell">
           <p id="par_id231614360519973" class="tableheadintable">List of Methods in the Database Service</p>
       </td>
   </tr>
   <tr>
       <td rowspan="" colspan="">
         <p id="par_id611614360519255" class="tablecontentintable">
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#CloseDatabase">CloseDatabase</a><br>
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#DFunctions">DAvg</a><br>
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#DFunctions">DCount</a>
         </p>
       </td>
       <td rowspan="" colspan="">
         <p id="par_id611614360519104" class="tablecontentintable">
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#DFunctions">DMin</a><br>
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#DFunctions">DMax</a><br>
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#DFunctions">DSum</a>
         </p>
       </td>
       <td rowspan="" colspan="">
         <p id="par_id611614360518452" class="tablecontentintable">
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#DLookup">DLookup</a><br>
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#GetRows">GetRows</a><br>
           <a target="_top" href="en-US/text/sbasic/shared/03/sf_database.html#RunSql">RunSql</a>
         </p>
       </td>
   </tr>
</table>
<br>

<a name="CloseDatabase"></a>
  
     <a name="bm_id991587913266189"></a>
         <meta itemprop="keywords" content="Database Service,CloseDatabase">
     
  <h2 id="hd_id76158791326673">CloseDatabase</h2>
  <p id="par_id201587913266596" class="paragraph">Closes the current database connection.</p>
  <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682">
<a name="functsyntax"></a>Syntax:</h3>
</div>
  <p id="par_id821625699786747" class="paragraph">
    <span class="input" data-tooltip="Click on text to copy to clipboard">db.CloseDatabase()</span>
  </p>
  <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233">
<a name="functexample"></a>Example:</h3>
</div>
  <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
    myDatabase.CloseDatabase() ' Basic
  </code></pre></div>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
    myDatabase.CloseDatabase() # Python
  </code></pre></div>


<a name="DFunctions"></a>
  
    <a name="bm_id861599488343584"></a>
        <meta itemprop="keywords" content="Database Service,DAvg">
    
    <a name="bm_id221599488343636"></a>
        <meta itemprop="keywords" content="Database Service,DCount">
    
    <a name="bm_id261599488343619"></a>
        <meta itemprop="keywords" content="Database Service,DMax">
    
    <a name="bm_id231599488343876"></a>
        <meta itemprop="keywords" content="Database Service,DMin">
    
    <a name="bm_id831599488343138"></a>
        <meta itemprop="keywords" content="Database Service,DSum">
    
    <h2 id="hd_id281596554849363">DAvg, DCount, DMin, DMax, DSum</h2>
    <p id="par_id13159655484952" class="paragraph">Computes the given aggregate function on a field or expression belonging to a table.</p>
    <p id="par_id101615148468548" class="paragraph">Optionally, a SQL <span class="literal">WHERE</span> clause can be specified as a filter that will be applied prior to the aggregate function.</p>
    <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682">
<a name="functsyntax"></a>Syntax:</h3>
</div>
    <p id="par_id481625700732942" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">db.DAvg(expression: str, tablename: str, [criteria: str]): any</span>
    </p>
    <p id="par_id481625700732113" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">db.DCount(expression: str, tablename: str, [criteria: str]): any</span>
    </p>
    <p id="par_id481625700730298" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">db.DMin(expression: str, tablename: str, [criteria: str]): any</span>
    </p>
    <p id="par_id481625700720177" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">db.DMax(expression: str, tablename: str, [criteria: str]): any</span>
    </p>
    <p id="par_id481625700731179" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">db.DSum(expression: str, tablename: str, [criteria: str]): any</span>
    </p>
    <div class="embedded">
<a name="functparameters"></a>
<h3 id="hd_id061420171139084157">
<a name="functparameters"></a>Parameters:</h3>
</div>
    <p id="par_id441596554849949" class="paragraph"><span class="emph">expression</span>: A SQL expression in which the field names are surrounded with square brackets.</p>
    <p id="par_id381596554849698" class="paragraph"><span class="emph">tablename</span>: A table name (without square brackets).</p>
    <p id="par_id521596554849185" class="paragraph"><span class="emph">criteria</span>: A <span class="literal">WHERE</span> clause without the "WHERE" keyword, in which field names are surrounded with square brackets.</p>
    <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233">
<a name="functexample"></a>Example:</h3>
</div>
    <p id="par_id781615150306678" class="paragraph">The example below assumes the file <span class="literal">Employees.odb</span> has a table named <span class="literal">EmployeeData</span>.</p>
    <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501">In Basic</h5>
</div>
    <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
      GlobalScope.BasicLibraries.LoadLibrary("ScriptForge")
      Dim myDB as Variant
      Set myDB = CreateScriptService("Database", "/home/user/Databases/Employees.odb")
      ' Counts the number of employees in the table
      MsgBox myDB.DCount("[ID]", "EmployeeData")
      ' Returns the sum of all salaries in the table
      MsgBox myDB.DSum("[Salary]", "EmployeeData")
      ' Below are some examples of how tables can be filtered
      MsgBox myDB.DCount("[ID]", "EmployeeData", "[Position] = 'Manager'")
      MsgBox myDB.DCount("[ID]", "EmployeeData", "[Position] = 'Sales' AND [City] = 'Chicago'")
      MsgBox myDB.DCount("[ID]", "EmployeeData", "[FirstName] LIKE 'Paul%'")
    </code></pre></div>
    <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993">In Python</h5>
</div>
    <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
      myDB = CreateScriptService("Database", "/home/user/Databases/Employees.odb")
      bas = CreateScriptService("Basic")
      bas.MsgBox(myDB.DCount("[ID]", "EmployeeData"))
      bas.MsgBox(myDB.DSum("[Salary]", "EmployeeData"))
      bas.MsgBox(myDB.DCount("[ID]", "EmployeeData", "[Position] = 'Manager'"))
      bas.MsgBox(myDB.DCount("[ID]", "EmployeeData", "[Position] = 'Sales' AND [City] = 'Chicago'"))
      bas.MsgBox(myDB.DCount("[ID]", "EmployeeData", "[FirstName] LIKE 'Paul%'"))
    </code></pre></div>


<a name="DLookup"></a>
  
    <a name="bm_id161599488113736"></a>
        <meta itemprop="keywords" content="Database Service,DLookup">
    
    <h2 id="hd_id151599488113565">DLookup</h2>
    <p id="par_id41599488113961" class="paragraph">Computes a SQL expression on a single record returned by a <span class="literal">WHERE</span> clause defined by the <span class="literal">Criteria</span> parameter.</p>
    <p id="par_id601615381471954" class="paragraph">If the query returns multiple records, only the first one is considered. Use the <span class="literal">OrderClause</span> parameter to determine how query results are sorted.</p>
    <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682">
<a name="functsyntax"></a>Syntax:</h3>
</div>
    <p id="par_id41625701240138" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">db.DLookup(expression: str, tablename: str, [criteria:str], [orderclause: str]): any</span>
    </p>
    <div class="embedded">
<a name="functparameters"></a>
<h3 id="hd_id061420171139084157">
<a name="functparameters"></a>Parameters:</h3>
</div>
    <p id="par_id671599488113986" class="paragraph"><span class="emph">expression</span>: A SQL expression in which the field names are surrounded with square brackets.</p>
    <p id="par_id441599488113247" class="paragraph"><span class="emph">tablename</span>: A table name (without square brackets).</p>
    <p id="par_id40159948811316" class="paragraph"><span class="emph">criteria</span>: A <span class="literal">WHERE</span> clause without the "WHERE" keyword, in which field names are surrounded with square brackets.</p>
    <p id="par_id71599488689029" class="paragraph"><span class="emph">orderclause</span>: An <span class="literal">ORDER BY</span> clause without the "ORDER BY" keywords. Field names should be surrounded with square brackets.</p>
    <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233">
<a name="functexample"></a>Example:</h3>
</div>
    <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501">In Basic</h5>
</div>
    <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
      MsgBox myDB.DLookup("[FirstName]", "EmployeeData", Criteria := "[LastName] LIKE 'Smith'", OrderClause := "[FirstName] DESC")
      MsgBox myDB.DLookup("[Salary]", "EmployeeData", Criteria := "[ID] = '3'")
      MsgBox myDB.DLookup("[Quantity] * [Value]", "Sales", Criteria := "[SaleID] = '5014'")
    </code></pre></div>
    <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993">In Python</h5>
</div>
    <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
      bas = CreateScriptService("Basic")
      bas.MsgBox(myDB.DLookup("[FirstName]", "EmployeeData", criteria = "[LastName] LIKE 'Smith'", orderclause = "[FirstName] DESC"))
      bas.MsgBox(myDB.DLookup("[Salary]", "EmployeeData", criteria = "[ID] = '3'"))
      bas.MsgBox(myDB.DLookup("[Quantity] * [Value]", "Sales", criteria = "[SaleID] = '5014'"))
    </code></pre></div>


<a name="GetRows"></a>
  
    <a name="bm_id91599489278645"></a>
        <meta itemprop="keywords" content="Database Service,GetRows">
    
    <h2 id="hd_id79159948927847">GetRows</h2>
    <p id="par_id481599489278579" class="paragraph">Stores the contents of a table or the results of a <span class="literal">SELECT</span> query or of an SQL statement in a two-dimensional array. The first index in the array corresponds to the rows and the second index refers to the columns.</p>
    <p id="par_id821615384762425" class="paragraph">An upper limit can be specified to the number of returned rows. Optionally column names may be inserted in the first row of the array.</p>
    <p id="par_id271599490209915" class="paragraph">The returned array will be empty if no rows are returned and the column headers are not required.</p>
    <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682">
<a name="functsyntax"></a>Syntax:</h3>
</div>
    <p id="par_id121625701537873" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">db.GetRows(sqlcommand: str, directsql: bool = False, header: bool = False, maxrows: int = 0): any</span>
    </p>
    <div class="embedded">
<a name="functparameters"></a>
<h3 id="hd_id061420171139084157">
<a name="functparameters"></a>Parameters:</h3>
</div>
    <p id="par_id451599489278429" class="paragraph"><span class="emph">sqlcommand</span>: A table or query name (without square brackets) or a <span class="literal">SELECT</span> SQL statement.</p>
    <p id="par_id271599489278141" class="paragraph"><span class="emph">directsql</span>: When <span class="literal">True</span>, the SQL command is sent to the database engine without pre-analysis. Default is <span class="literal">False</span>. This argument is ignored for tables. For queries, the applied option is the one set when the query was defined.</p>
    <p id="par_id941599489278747" class="paragraph"><span class="emph">header</span>: When <span class="literal">True</span>, the first row of the returned array contains the column headers.</p>
    <p id="par_id591599489278926" class="paragraph"><span class="emph">maxrows</span>: The maximum number of rows to return. The default is zero, meaning there is no limit to the number of returned rows.</p>
    <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233">
<a name="functexample"></a>Example:</h3>
</div>
    <p id="par_id721615385125947" class="paragraph">Below are a few examples of how the <span class="literal">GetRows</span> method can be used:</p>
    <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501">In Basic</h5>
</div>
    <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
      Dim queryResults as Variant
      ' Returns all rows in the table with column headers
      queryResults = myDB.GetRows("EmployeeData", Header := True)
      ' Returns the first 50 employee records ordered by the 'FirstName' field
      queryResults = myDB.GetRows("SELECT * FROM EmployeeData ORDER BY [FirstName]", MaxRows := 50)
    </code></pre></div>
    <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993">In Python</h5>
</div>
    <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
      queryResults = myDB.GetRows("EmployeeData", header = True)
      queryResults = myDB.GetRows("SELECT * FROM EmployeeData ORDER BY [FirstName]", maxrows = 50)
    </code></pre></div>


<a name="RunSql"></a>
  
    <a name="bm_id781599490609499"></a>
        <meta itemprop="keywords" content="Database Service,RunSql">
    
    <h2 id="hd_id80159949060917">RunSql</h2>
    <p id="par_id31599490609759" class="paragraph">Executes an action query of an SQL statement such as creating a table, as well as inserting, updating and deleting records.</p>
    <p id="par_id331615385491925" class="paragraph">The method returns <span class="literal">True</span> when successful.</p>
    <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id21599490810021">The <span class="literal">RunSql</span> method is rejected with an error message in case the database was previously opened in read-only mode.</p></div>
</div>
<br>
    <div class="embedded">
<a name="functsyntax"></a>
<h3 id="hd_id061420171139089682">
<a name="functsyntax"></a>Syntax:</h3>
</div>
    <p id="par_id421625701780046" class="paragraph">
      <span class="input" data-tooltip="Click on text to copy to clipboard">db.RunSql(sqlcommand: str, directsql: bool = False): bool</span>
    </p>
    <div class="embedded">
<a name="functparameters"></a>
<h3 id="hd_id061420171139084157">
<a name="functparameters"></a>Parameters:</h3>
</div>
    <p id="par_id701599490609473" class="paragraph"><span class="emph">sqlcommand</span>: A query name (without square brackets) or a SQL statement.</p>
    <p id="par_id51599490609377" class="paragraph"><span class="emph">directsql</span>: When <span class="literal">True</span>, the SQL command is sent to the database engine without pre-analysis. (Default = <span class="literal">False</span>). For queries, the applied option is the one set when the query was defined.</p>
    <div class="embedded">
<a name="functexample"></a>
<h3 id="hd_id061420171139088233">
<a name="functexample"></a>Example:</h3>
</div>
    <div class="embedded">
<a name="In_Basic"></a>
<h5 id="hd_id191620312698501">In Basic</h5>
</div>
    <div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
      myDatabase.RunSql("INSERT INTO [EmployeeData] VALUES(25, 'Smith', 'John')", DirectSQL := True)
    </code></pre></div>
    <div class="embedded">
<a name="In_Python"></a>
<h5 id="hd_id831620312769993">In Python</h5>
</div>
    <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
      myDatabase.RunSql("INSERT INTO [EmployeeData] VALUES(25, 'Smith', 'John')", directsql = True)
    </code></pre></div>


    <div class="embedded">
<a name="SF_InternalUse"></a>
      <div class="warning">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" title="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id851506659675843">All <span class="literal">ScriptForge</span> Basic routines or identifiers that are prefixed with an underscore character "_" are reserved for internal use. They are not meant be used in Basic macros or Python scripts.</p></div>
</div>
<br>
    </div>
    <a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
      <div class="embedded"><p class="embedded"><a name="DocumentService"></a><a target="_top" href="en-US/text/sbasic/shared/03/sf_document.html"><span class="literal">SFDocuments</span>.<span class="literal">Document</span> service</a></p></div>
      <div class="embedded"><p class="embedded"><a name="FormService"></a><a target="_top" href="en-US/text/sbasic/shared/03/sf_form.html"><span class="literal">SFDocuments</span>.<span class="literal">Form</span> service</a></p></div>
      <div class="embedded"><p class="embedded"><a name="UIService"></a><a target="_top" href="en-US/text/sbasic/shared/03/sf_ui.html"><span class="literal">ScriptForge</span>.<span class="literal">UI</span> service</a></p></div>
    </div>
</div>
</div>
<div id="SearchFrame"></div>
<div id="DonationFrame"></div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/shared/03/sf_database.xhp" target="_blank">/text/sbasic/shared/03/sf_database.xhp</a></p>
<p>Title is: SFDatabases.Database service</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
<p id="bm_HID"></p>
</div></footer>
</body>
</html>
