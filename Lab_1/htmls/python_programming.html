<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Python : Programming with Python</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p>LibreOffice 7.3 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" onclick="setupModules('en-US');">Module</button><nav id="modules-nav"></nav>
</div></div></header><aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search" placeholder="Search in chosen module"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">
    <a name="N0218"></a>
        <meta itemprop="keywords" content="Python,Programming">
        <meta itemprop="keywords" content="XSCRIPTCONTEXT,Python">
        <meta itemprop="keywords" content="XSCRIPTCONTEXT,getComponentContext()">
        <meta itemprop="keywords" content="uno.py">
        <meta itemprop="keywords" content="uno.py,getComponentContext()">
    
    <a name="pythonprogramming"></a>
        <h1 id="hd_id691546462755220">
<a name="pythonprogrammingheading"></a>Programming with Python Scripts</h1>
    
    <p id="N0220" class="paragraph">A Python macro is a function within a .py file, identified as a module. Unlike LibreOffice Basic and its dozen of <a target="_top" href="en-US/text/sbasic/shared/uno_objects.html">UNO objects functions or services</a>, Python macros use the <span class="literal">XSCRIPTCONTEXT</span> UNO single object, shared with JavaScript and BeanShell. The <span class="literal">g_exportedScripts</span> global tuple explicitly lists selectable macros from a module. Python modules hold autonomous code logic, and are independent from one another.</p>
    <h2 id="N0221">XSCRIPTCONTEXT Global Variable</h2>
    <p id="N0222" class="paragraph">Genuine Basic UNO facilities can be inferred from <span class="literal">XSCRIPTCONTEXT</span> global variable. Refer to LibreOffice API for a complete <a target="_blank" href="https://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1script_1_1provider_1_1XScriptContext.html">description of XSCRIPTCONTEXT</a>. <span class="literal">XSCRIPTCONTEXT</span> methods summarize as:</p>
    <table border="1" class="" cellpadding="0" cellspacing="0">
        <tr>
            <td rowspan="" colspan="" class="tableheadcell">
                <p id="N0224" class="tableheadintable">Methods</p>
            </td>
            <td rowspan="" colspan="" class="tableheadcell">
                <p id="N0225" class="tableheadintable">Description</p>
            </td>
            <td rowspan="" colspan="" class="tableheadcell">
                <p id="N0226" class="tableheadintable">Mapped in Basic as</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0227" class="tablecontentintable">getDocument()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0228" class="tablecontentintable">The document reference on which the script can operate.</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0229" class="tablecontentintable">ThisComponent</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0230" class="tablecontentintable">getDesktop()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0231" class="tablecontentintable">The desktop reference on which the script can operate.</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0232" class="tablecontentintable">StarDesktop</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0233" class="tablecontentintable">getComponentContext()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0234" class="tablecontentintable">The component context which the script can use to create other uno components.</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0235" class="tablecontentintable">GetDefaultContext</p>
            </td>
        </tr>
    </table>
<br>
    <p id="N0237" class="paragraph"><span class="emph">HelloWorld</span> and <span class="emph">Capitalise</span> installation shared scripts illustrate UNO-related macros making use of <span class="literal">XSCRIPTCONTEXT</span> global variable.</p>
    <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="N0238">Python standard output file is not available when running Python macros from <span class="menuitem">Tools - Macros - Run Macro</span> menu. Refer to <span class="emph">Input/Output to Screen</span> for more information.</p></div>
</div>
<br>
    <h2 id="N0239">Module import</h2>
    <div class="warning">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/warning.svg" alt="warning" title="warning" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="N0240"><span class="literal">XSCRIPTCONTEXT</span> is not provided to imported modules.</p></div>
</div>
<br>
    <a name="PythonFileSystemImport"></a>
        <p id="N0241" class="paragraph">LibreOffice Basic libraries contain classes, routines and variables, Python modules contain classes, functions and variables. Common pieces of reusable Python or UNO features must be stored in <a target="_top" href="en-US/text/sbasic/python/python_locations.html">My macros</a> within <span class="literal">(User Profile)/Scripts/python/pythonpath</span>. Python libraries help organize modules in order to prevent module name collisions. Import <span class="literal">uno.py</span> inside shared modules.</p>
    
    <p id="N0242" class="paragraph">Genuine BASIC UNO facilities can be inferred using <span class="literal">uno.py</span> module. Use <a target="_top" href="en-US/text/sbasic/python/python_shell.html">Python interactive shell</a> to get a complete module description using <span class="literal">dir()</span> and <span class="literal">help()</span> Python commands.</p>
    <table border="1" class="" cellpadding="0" cellspacing="0">
        <tr>
            <td rowspan="" colspan="" class="tableheadcell">
                <p id="N0244" class="tableheadintable">Functions</p>
            </td>
            <td rowspan="" colspan="" class="tableheadcell">
                <p id="N0245" class="tableheadintable">Description</p>
            </td>
            <td rowspan="" colspan="" class="tableheadcell">
                <p id="N0246" class="tableheadintable">Mapped in Basic as</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0247" class="tablecontentintable">absolutize()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0248" class="tablecontentintable">Returns an absolute file url from the given urls.</p>
            </td>
            <td rowspan="" colspan="">
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0250" class="tablecontentintable">createUnoStruct()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0251" class="tablecontentintable">Creates a UNO struct or exception given by typeName.</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0252" class="tablecontentintable">CreateUNOStruct()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0253" class="tablecontentintable">fileUrlToSystemPath()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0254" class="tablecontentintable">Returns a system path.</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0255" class="tablecontentintable">ConvertFromURL()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0256" class="tablecontentintable">getClass()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0257" class="tablecontentintable">Returns the class of a concrete UNO exception, struct, or interface.</p>
            </td>
            <td rowspan="" colspan="">
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0259" class="tablecontentintable">getComponentContext()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0260" class="tablecontentintable">Returns the UNO component context used to initialize the Python runtime.</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0261" class="tablecontentintable">GetDefaultContext()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0262" class="tablecontentintable">Enum()</p>
                <p id="N0263" class="tablecontentintable">getConstantByName()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0264" class="tablecontentintable">Looks up the value of an IDL constant by giving its explicit name.</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0265" class="tablecontentintable">See API constant groups</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0266" class="tablecontentintable">isInterface()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0267" class="tablecontentintable">Returns True, when obj is a class of a UNO interface.</p>
            </td>
            <td rowspan="" colspan="">
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0269" class="tablecontentintable">systemPathToFileUrl()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0270" class="tablecontentintable">Returns a file URL for the given system path.</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0271" class="tablecontentintable">ConvertToURL()</p>
            </td>
        </tr>
    </table>
<br>
    <p id="N0272" class="paragraph"><span class="emph">LibreLogo</span> and <span class="emph">TableSample</span> installation shared scripts use <span class="literal">uno.py</span> module.</p>
    <h2 id="N0273">More Python-Basic samples</h2>
    <table border="1" class="" cellpadding="0" cellspacing="0">
        <tr>
            <td rowspan="" colspan="" class="tableheadcell">
                <p id="N0275" class="tableheadintable">Python UNO</p>
            </td>
            <td rowspan="" colspan="" class="tableheadcell">
                <p id="N0276" class="tableheadintable">Basic UNO features</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0277" class="tablecontentintable">ctx = uno.getComponentContext()</p>
                <p id="N0278" class="tablecontentintable">smgr = ctx.getServiceManager()</p>
                <p id="N0279" class="tablecontentintable">obj = smgr.createInstanceWithContext( .. , ctx)</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0280" class="tablecontentintable">CreateUnoService()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0284" class="tablecontentintable">See <a target="_top" href="en-US/text/sbasic/python/python_dialogs.html">Opening a Dialog</a></p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0285" class="tablecontentintable">CreateUnoDialog()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0286" class="tablecontentintable">See <a target="_top" href="en-US/text/sbasic/python/python_listener.html">Creating a Listener</a></p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0287" class="tablecontentintable">CreateUnoListener()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0288" class="tablecontentintable">See UNO data types</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0289" class="tablecontentintable">CreateUnoValue()</p>
                <p id="N0290" class="tablecontentintable">CreateObject()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
            </td>
            <td rowspan="" colspan="">
                <p id="N0292" class="tablecontentintable">EqualUnoObjects()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0281" class="tablecontentintable">ctx = uno.getComponentContext()</p>
                <p id="N0282" class="tablecontentintable">smgr = ctx.getServiceManager()</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0283" class="tablecontentintable">GetProcessServiceManager()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0292" class="tablecontentintable">def hasUnoInterfaces(obj, *interfaces):</p>
                <p id="N0293" class="tablecontentintable">return set(interfaces).issubset(t.typeName for t in obj.Types)</p>
                
            </td>
            <td rowspan="" colspan="">
                <p id="N0294" class="tablecontentintable">HasUnoInterfaces()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
            </td>
            <td rowspan="" colspan="">
                <p id="N0296" class="tablecontentintable">IsUnoStruct()</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0297" class="tablecontentintable">ctx = uno.getComponentContext()</p>
                <p id="N0298" class="tablecontentintable">smgr = ctx.getServiceManager()</p>
                <p id="N0299" class="tablecontentintable">DESK = 'com.sun.star.frame.Desktop'</p>
                <p id="N0300" class="tablecontentintable">desktop = smgr.createInstanceWithContext(DESK , ctx)</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0301" class="tablecontentintable">StarDesktop</p>
            </td>
        </tr>
        <tr>
            <td rowspan="" colspan="">
                <p id="N0298" class="tablecontentintable">desktop = smgr.createInstanceWithContext(DESK , ctx)</p>
                <p id="N0299" class="tablecontentintable">doc = desktop.CurrentComponent</p>
            </td>
            <td rowspan="" colspan="">
                <p id="N0301" class="tablecontentintable">ThisComponent</p>
            </td>
        </tr>
    </table>
<br>
    <h2 id="N0297">Importing an embedded Module</h2>
    <a name="PythonEmbeddedImport"></a>
        <p id="N0298" class="paragraph">Similarly to LibreOffice Basic that supports browsing and dynamic loading of libraries, Python libraries can be explored and imported on demand. For more information on library containers, visit <a target="_blank" href="https://api.libreoffice.org/">LibreOffice Application Programming Interface</a> (API) or download <a target="_blank" href="https://www.libreoffice.org/download/download/">LibreOffice Software Development Kit</a> (SDK).</p>
        <p id="N0299" class="paragraph">Importing a Python document embedded module is illustrated below, exception handling is not detailed:</p>
        <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
            import uno, sys
            
            def load_library(library_name: str, module_name=None):
                """ load library and import module
                
                Adapted from 'BibliothÃ¨que de fonctions' by Hubert Lambert
                at https://forum.openoffice.org/fr/forum/viewtopic.php?p=286213"""
                doc = XSCRIPTCONTEXT.getDocument()  # current document
                url = uno.fileUrlToSystemPath( \
                    '{}/{}'.format(doc.URL, 'Scripts/python'+library_name))  # ConvertToURL()
                if not url in sys.path:  # add path if necessary
                    sys.path.insert(0, url)  # doclib takes precedence
                if module_name:  # import if requested
                    return zipimport.zipimporter(url).load_module(module_name)
            
            def import_embedded_python():
                ui = load_library("my_gui",'screen_io')  # add &lt;lib&gt; path + import &lt;module&gt; 
                ui.MsgBox(sys.modules.keys())
            
            g_exportedScripts = (import_embedded_python,)  # Public macros
        </code></pre></div>
    
    <a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
        <p id="N0321" class="paragraph"><a target="_top" href="en-US/text/sbasic/shared/uno_objects.html">Basic UNO Objects, Functions and Services</a></p>
        <div class="embedded"><p class="embedded"><a name="pythonimporth1"></a><a target="_top" href="en-US/text/sbasic/python/python_import.html">Importing Python Modules</a></p></div>
        <div class="embedded"><p class="embedded"><a name="ioscreen"></a><a target="_top" href="en-US/text/sbasic/python/python_screen.html">Input/Output to Screen</a></p></div>
        <div class="embedded"><p class="embedded"><a name="pythonscriptshelp"></a><a target="_top" href="en-US/text/sbasic/python/main0000.html">LibreOffice Python Scripts Help</a></p></div>
    </div>
</div>
</div>
<div id="SearchFrame"></div>
<div id="DonationFrame"></div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/python/python_programming.xhp" target="_blank">/text/sbasic/python/python_programming.xhp</a></p>
<p>Title is: Python : Programming with Python</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
<p id="bm_HID"></p>
</div></footer>
</body>
</html>
