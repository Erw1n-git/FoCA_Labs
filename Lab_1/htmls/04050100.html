<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Trend Lines</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p>LibreOffice 7.3 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" onclick="setupModules('en-US');">Module</button><nav id="modules-nav"></nav>
</div></div></header><aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search" placeholder="Search in chosen module"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">

<a name="bm_id1744743"></a>
  <meta itemprop="keywords" content="calculating,regression curves">
  <meta itemprop="keywords" content="regression curves in charts">
  <meta itemprop="keywords" content="trend lines in charts">
  <meta itemprop="keywords" content="mean value lines in charts">


<a name="bm_id2001709"></a>
<a name="bm_@@nowidget@@"></a>
<a name="bm_id2001710"></a>

<h1 id="hd_id5409405"> <a name="regression"></a>Trend Lines</h1>
<p id="par_id7272255" class="paragraph"> <a name="trendlinestext"></a> <span class="avis">Trend lines can be added to all 2D chart types except for Pie and Stock charts.</span>  </p>

<a name="howtoget"></a><div class="howtoget">
<div><p class="howtogetheader"><a name="wie"></a>To access this command...
</p></div>
<div class="howtogetbody">
<div class="embedded"><p class="embedded"><a name="trendlines"></a>Choose <span class="emph">Insert - Trend Line</span> (Charts)
</p></div>
</div>
</div>
<br>
<a name="bm_id6944181"></a>
<p id="par_id5716727" class="paragraph"></p>
<a name="bm_id886257"></a>
<p id="par_id5840021" class="paragraph"></p>
<a name="bm_id8892483"></a>
<p id="par_id9417096" class="paragraph"></p>
<a name="bm_id7198400"></a>
<p id="par_id8482924" class="paragraph"></p>
<a name="bm_id180820161047491735"></a>
<p id="par_id180820161052123210" class="paragraph"></p>
<a name="bm_id180820161152296070"></a>
<a name="bm_id180820161152296071"></a>
<p id="par_id180820161102568315" class="paragraph"></p>
<a name="bm_id180820161104335824"></a>
<p id="par_id180820161105546053" class="paragraph"></p>
<a name="bm_id180820161157368991"></a>
<a name="bm_id180820161157368992"></a>
<p id="par_id180820161107537745" class="paragraph"></p>
<a name="bm_id180820161429301956"></a>
<a name="bm_id180820161429301957"></a>
<p id="par_id180820161112599880" class="paragraph"></p>
<a name="bm_id180820161430141657"></a>
<a name="bm_id180820161430141658"></a>
<p id="par_id180820161117252261" class="paragraph"></p>
<a name="bm_id180820161504266451"></a>
<a name="bm_id180820161504266452"></a>
<p id="par_id18082016111837138" class="paragraph"></p>
<a name="bm_id180820161122038174"></a>
<p id="par_id180820161124272765" class="paragraph"></p>
<a name="bm_id180820161125169514"></a>
<p id="par_id180820161126064822" class="paragraph"></p>
<a name="bm_id4724875"></a>
<p id="par_id8962370" class="paragraph"></p>
<a name="bm_id9068880"></a>
<p id="par_id6889858" class="paragraph"></p>
<a name="bm_id180820161515523577"></a>
<a name="bm_id180820161515523578"></a>
<p id="par_id180820161133305870" class="paragraph"></p>
<a name="bm_id180820161516105398"></a>
<a name="bm_id180820161516105399"></a>
<p id="par_id180820161134155865" class="paragraph"></p>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="Note Icon 
" title="Note Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p>If you insert a trend line to a chart type that uses categories, like <span class="emph">Line</span> or <span class="emph">Column</span>, then the numbers 1, 2, 3, <span class="emph">â€¦</span> are used as x-values to calculate the trend line. For such charts the XY chart type might be more suitable.</p></div>
</div>
<br>

<a name="bm_id7854243"></a>
<ol itemprop="HowTo" itemscope="true" itemtype="http://schema.org/HowToSection">
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
    <p id="par_id4349192" class="paragraph">To insert a trend line for a data series, first double-click the chart to enter edit mode and select the data series in the chart to which a trend line is to be created.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
    <p id="par_id801630627531175" class="listitem">Choose <span class="menuitem">Insert - Trend Line</span>, or right-click the data series to open the context menu, and choose <span class="menuitem">Insert Trend Line</span>.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
    <p id="par_id180820161539033867" class="paragraph">Mean Value Lines are special trend lines that show the mean value. Use <span class="menuitem">Insert - Mean Value Lines</span> to insert mean value lines for data series.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
    <p id="par_id9337443" class="paragraph">To delete a trend line or mean value line, click the line, then press the Del key.</p>
  </li>
</ol>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" title="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id801630627733593">The menu item <span class="menuitem">Insert - Trend Line</span> is only available when the chart is in edit mode. It will appear grayed out if the chart is in edit mode but no data series is selected.</p></div>
</div>
<br>
<p id="par_id9569689" class="paragraph">The trend line has the same color as the corresponding data series. To change the line properties, select the trend line and choose <span class="menuitem">Format - Format Selection - Line</span>.</p>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="note" title="note" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id296334">A trend line is shown in the legend automatically. Its name can be defined in options of the trend line.</p></div>
</div>
<br>
<a name="bm_id2754601"></a>

<h2 id="hd_id180820161534333508">Trend Line Equation and Coefficient of Determination</h2>
<a name="bm_id2754600"></a>
<p id="par_id8962065" class="paragraph">When the chart is in edit mode, LibreOffice gives you the equation of the trend line and the coefficient of determination R<sup>2</sup>, even if they are not shown: click on the trend line to see the information in the status bar.</p>
<p id="par_id846888" class="paragraph"><span class="avis">To show the trend line equation, select the trend line in the chart, right-click to open the context menu, and choose <span class="menuitem">Insert Trend Line Equation</span>.</span></p>
<p id="par_id8962066" class="paragraph">To change format of values (use less significant digits or scientific notation), select the equation in the chart, right-click to open the context menu, and choose <span class="menuitem">Format Trend Line Equation - Numbers</span>.</p>
<p id="par_id180820161627109994" class="paragraph">Default equation uses <span class="literal">x</span> for abscissa variable, and <span class="literal">f(x)</span> for ordinate variable. To change these names, select the trend line, choose <span class="menuitem">Format - Format Selection â€“ Type</span> and enter names in <span class="literal">X Variable Name</span> and <span class="literal">Y Variable Name</span> edit boxes.</p>
<a name="bm_id2754602"></a>
<p id="par_id18082016163702791" class="paragraph">To show the coefficient of determination R<sup>2</sup>, select the equation in the chart, right-click to open the context menu, and choose <span class="menuitem">Insert R</span><sup><span class="menuitem">2</span></sup>.</p>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="Note Icon 
" title="Note Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p>If intercept is forced, coefficient of determination R<sup>2</sup> is not calculated in the same way as with free intercept. R<sup>2</sup> values can not be compared with forced or free intercept.</p></div>
</div>
<br>

<h2 id="hd_id180820161534333509">Trend Lines Curve Types</h2>
<p id="par_id18082016153820777" class="paragraph">The following regression types are available:</p>

<ul itemprop="Unordered" itemscope="true" itemtype="http://schema.org/ItemList">
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
    <p id="par_id180820161604098009" class="paragraph"><span class="emph">Linear</span> trend line: regression through equation <span class="literal">y=aâˆ™x+b</span>. Intercept <span class="literal">b</span> can be forced.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id180820161612524298" class="paragraph"><span class="emph">Polynomial</span> trend line: regression through equation <span class="literal">y=Î£</span><sub><span class="literal">i</span></sub><span class="literal">(a</span><sub><span class="literal">i</span></sub><span class="literal">âˆ™x</span><sup><span class="literal">i</span></sup><span class="literal">)</span>. Intercept <span class="literal">a</span><sub><span class="literal">0</span></sub> can be forced. Degree of polynomial must be given (at least 2).</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
    <p id="par_id180820161612525364" class="paragraph"><span class="emph">Logarithmic</span> trend line: regression through equation <span class="literal">y=aâˆ™ln(x)+b</span>.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id180820161612526680" class="paragraph"><span class="emph">Exponential</span> trend line: regression through equation <span class="literal">y=bâˆ™exp(aâˆ™x)</span>.This equation is equivalent to <span class="literal">y=bâˆ™m</span><sup><span class="literal">x</span></sup> with <span class="literal">m=exp(a)</span>. Intercept <span class="literal">b</span> can be forced.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id180820161612527230" class="paragraph"><span class="emph">Power</span> trend line: regression through equation <span class="literal">y=bâˆ™x</span><sup><span class="literal">a</span></sup>.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
    <p id="par_id180820161617342768" class="paragraph"><span class="emph">Moving average</span> trend line: simple moving average is calculated with the <span class="emph">n</span> previous y-values, <span class="emph">n</span> being the period. No equation is available for this trend line.</p>
  </li>
</ul>

<h2 id="hd_id9204077">Constraints</h2>
<p id="par_id7393719" class="paragraph"> The calculation of the trend line considers only data pairs with the following values:</p>

<ul itemprop="Unordered" itemscope="true" itemtype="http://schema.org/ItemList">
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
    <p id="par_id7212744" class="paragraph">Logarithmic trend line: only positive x-values are considered.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
    <p id="par_id1664479" class="paragraph">Exponential trend line: only positive y-values are considered, except if all y-values are negative: regression will then follow equation <span class="literal">y=-bâˆ™exp(aâˆ™x)</span>.</p>
  </li>
  <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id8734702" class="paragraph">Power trend line: only positive x-values are considered; only positive y-values are considered, except if all y-values are negative: regression will then follow equation<span class="literal"> y=-bâˆ™x</span><sup><span class="literal">a</span></sup>.</p>
  </li>
</ul>
<p id="par_id181279" class="paragraph">You should transform your data accordingly; it is best to work on a copy of the original data and transform the copied data.</p>

<h2 id="hd_id180820161528021520">Calculate Parameters in Calc</h2>
<p id="par_id7735221" class="paragraph">You can also calculate the parameters using Calc functions as follows.</p>

<h3 id="hd_id5744193">The linear regression equation</h3>
<p id="par_id9251991" class="paragraph">The <span class="emph">linear regression</span> follows the equation <span class="literal">y=m*x+b</span>.</p>
<p id="par_id7951902" class="code">m = SLOPE(Data_Y;Data_X) </p>
<p id="par_id6637165" class="code">b = INTERCEPT(Data_Y ;Data_X) </p>
<p id="par_id7879268" class="paragraph">Calculate the coefficient of determination by</p>
<p id="par_id9244361" class="code">r<sup>2</sup> = RSQ(Data_Y;Data_X) </p>
<p id="par_id2083498" class="paragraph">Besides m, b and r<sup>2</sup> the array function <span class="emph">LINEST</span> provides additional statistics for a regression analysis.</p>

<h3 id="hd_id2538834">The logarithmic regression equation</h3>
<p id="par_id394299" class="paragraph">The <span class="emph">logarithmic regression</span> follows the equation <span class="literal">y=a*ln(x)+b</span>.</p>
<p id="par_id2134159" class="code">a = SLOPE(Data_Y;LN(Data_X)) </p>
<p id="par_id5946531" class="code">b = INTERCEPT(Data_Y ;LN(Data_X)) </p>
<p id="par_id5649281" class="code">r<sup>2</sup> = RSQ(Data_Y;LN(Data_X)) </p>

<h3 id="hd_id7874080">The exponential regression equation</h3>
<p id="par_id4679097" class="paragraph"> For exponential trend lines a transformation to a linear model takes place. The optimal curve fitting is related to the linear model and the results are interpreted accordingly.</p>
<p id="par_id9112216" class="paragraph">The exponential regression follows the equation <span class="literal">y=b*exp(a*x)</span> or <span class="literal">y=b*m</span><sup><span class="literal">x</span></sup>, which is transformed to <span class="literal">ln(y)=ln(b)+a*x</span> or <span class="literal">ln(y)=ln(b)+ln(m)*x</span> respectively.</p>
<p id="par_id4416638" class="code">a = SLOPE(LN(Data_Y);Data_X) </p>
<p id="par_id1039155" class="paragraph">The variables for the second variation are calculated as follows:</p>
<p id="par_id7184057" class="code">m = EXP(SLOPE(LN(Data_Y);Data_X)) </p>
<p id="par_id786767" class="code">b = EXP(INTERCEPT(LN(Data_Y);Data_X)) </p>
<p id="par_id7127292" class="paragraph">Calculate the coefficient of determination by</p>
<p id="par_id5437177" class="code">r<sup>2</sup> = RSQ(LN(Data_Y);Data_X) </p>
<p id="par_id6946317" class="paragraph">Besides m, b and r<sup>2</sup> the array function <span class="emph">LOGEST</span> provides additional statistics for a regression analysis.</p>

<h3 id="hd_id6349375">The power regression equation</h3>
<p id="par_id1857661" class="paragraph"> For <span class="emph">power regression</span> curves a transformation to a linear model takes place. The power regression follows the equation <span class="literal">y=b*x</span><sup><span class="literal">a</span></sup>, which is transformed to <span class="literal">ln(y)=ln(b)+a*ln(x)</span>.</p>
<p id="par_id8517105" class="code">a = SLOPE(LN(Data_Y);LN(Data_X)) </p>
<p id="par_id9827265" class="code">b = EXP(INTERCEPT(LN(Data_Y);LN(Data_X)) </p>
<p id="par_id2357249" class="code">r<sup>2</sup> = RSQ(LN(Data_Y);LN(Data_X)) </p>

<h3 id="hd_id7907040">The polynomial regression equation</h3>
<p id="par_id8918729" class="paragraph">For <span class="emph">polynomial regression</span> curves a transformation to a linear model takes place.</p>
<p id="par_id33875" class="paragraph">Create a table with the columns x, x<sup>2</sup>, x<sup>3</sup>, â€¦ , x<sup>n</sup>, y up to the desired degree n. </p>
<p id="par_id8720053" class="paragraph">Use the formula <span class="literal">=LINEST(Data_Y,Data_X)</span> with the complete range x to x<sup>n</sup> (without headings) as Data_X. </p>
<p id="par_id5068514" class="paragraph">The first row of the <span class="emph">LINEST</span> output contains the coefficients of the regression polynomial, with the coefficient of x<sup>n</sup> at the leftmost position.</p>
<p id="par_id8202154" class="paragraph">The first element of the third row of the <span class="emph">LINEST</span> output is the value of r<sup>2</sup>. See the <a target="_top" href="en-US/text/scalc/01/04060107.html#Section8"><span class="emph">LINEST</span></a> function for details on proper use and an explanation of the other output parameters.</p>

<a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
<p id="par_id4562211" class="paragraph"><a target="_top" href="en-US/text/schart/01/04050000.html">X/Y Error Bars</a></p>
<p id="par_id4562212" class="paragraph"><a target="_top" href="en-US/text/scalc/01/04060107.html#Section8">LINEST</a> function</p>
<p id="par_id4562216" class="paragraph"><a target="_top" href="en-US/text/scalc/01/04060107.html#Section7">LOGEST</a> function</p>
<p id="par_id4562213" class="paragraph"><a target="_top" href="en-US/text/scalc/01/04060185.html#slope">SLOPE</a> function</p>
<p id="par_id4562214" class="paragraph"><a target="_top" href="en-US/text/scalc/01/04060181.html#intercept">INTERCEPT</a> function</p>
<p id="par_id4562215" class="paragraph"><a target="_top" href="en-US/text/scalc/01/04060181.html#rsq">RSQ</a> function</p>
</div>
</div>
</div>
<div id="SearchFrame"></div>
<div id="DonationFrame"></div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/schart/01/04050100.xhp" target="_blank">/text/schart/01/04050100.xhp</a></p>
<p>Title is: Trend Lines</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
<p id="bm_HID"></p>
</div></footer>
</body>
</html>
