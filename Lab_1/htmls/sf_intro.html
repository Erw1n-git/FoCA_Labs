<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../../">
<noscript><meta http-equiv="refresh" content="0; URL=../../../../../en-US/noscript.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Creating Python Scripts with ScriptForge</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="en-US/langnames.js"></script><script type="text/javascript" src="flexsearch.debug.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<header id="TopLeftHeader"><a class="symbol" href="en-US/text/shared/05/new_help.html"><div></div></a><a class="logo" href="en-US/text/shared/05/new_help.html"><p>LibreOffice 7.3 Help</p></a><div class="dropdowns"><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" onclick="setupModules('en-US');">Module</button><nav id="modules-nav"></nav>
</div></div></header><aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search" placeholder="Search in chosen module"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="softwareHelp" itemscope="true" itemtype="http://schema.org/SoftwareApplication">
  <a name="bm_id41582391760114"></a>
    <meta itemprop="keywords" content="Python scripts with ScriptForge">
  
  <h1 id="hd_id461623364876507">
<a name="title"></a>Creating Python Scripts with <span class="literal">ScriptForge</span>
</h1>
  <h2 id="hd_id361623410405420">Differences between Basic and Python</h2>
  <p id="par_id41623410443946" class="paragraph">The <a target="_top" href="en-US/text/sbasic/shared/03/lib_ScriptForge.html">ScriptForge library</a> is available both for Basic and Python. Most services, methods and properties work identically in both programming languages. However, due to differences in how each language works, <span class="literal">ScriptForge</span> users must be aware of some characteristics of the library when using Python:</p>
  <ul itemprop="Unordered" itemscope="true" itemtype="http://schema.org/ItemList">
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id551623410718241" class="listitem"><span class="emph">Methods and Property names:</span> In Python, all methods and properties can be used in lowercased, ProperCased or camelCased formats.</p>
    </li>
        <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
        <p id="par_id741623411104297" class="listitem"><span class="emph">Arguments:</span> All keyword arguments passed on to methods are lowercased.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
        <p id="par_id441623411216354" class="listitem"><span class="emph">Dates:</span> All date objects are passed and returned as <span class="literal">datetime.datetime</span> native Python objects.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id891623411367669" class="listitem"><span class="emph">Arrays:</span> One-dimensional arrays are passed and returned as tuples (which is an immutable object). Two-dimensional arrays are passed and returned as tuples of tuples.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id981623411507442" class="listitem"><span class="emph">None:</span> Python's <span class="literal">None</span> keyword is equivalent to Basic's <span class="literal">Null</span>, <span class="literal">Empty</span> or <span class="literal">Nothing</span>.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id21623411611447" class="listitem"><span class="emph">UNO objects:</span> All UNO structures are exchanged between Basic and Python without any changes.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id651623412069496" class="listitem"><span class="emph">Debugging:</span> Whenever an error occurs in Python scripts that use <span class="literal">ScriptForge</span>, the error message provided by the Python execution stack displays the line of code that triggered the error. In Basic error messages do not display this information.</p>
    </li>
  </ul>
  <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id31623411828158">Visit <a target="_top" href="en-US/text/sbasic/python/main0000.html#">LibreOffice Python Scripts Help</a> for more information on Python scripting using LibreOffice.</p></div>
</div>
<br>
  <h2 id="hd_id391623411150080">Running Python scripts on LibreOffice</h2>
  <p id="par_id411623364895100" class="paragraph">Depending on what you intend to achieve, you may choose one of the following approaches to running Python scripts in LibreOffice:</p>
  <ul itemprop="Unordered" itemscope="true" itemtype="http://schema.org/ItemList">
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id681623365274024" class="listitem"><span class="emph">Run Scripts inside the current LibreOffice process:</span> Python scripts are executed from within the LibreOffice process by using the <span class="menuitem">Tools - Macros - Run Macro</span> menu or the APSO extension to call user scripts stored in the Python scripts folder. You can also use the APSO Python shell to interactively run Python scripts.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/ItemListUnordered">
      <p id="par_id761623365278133" class="listitem"><span class="emph">Run Scripts separately from the LibreOffice process:</span> Python scripts are executed from an external process that connects to an ongoing LibreOffice process using a socket.</p>
    </li>
  </ul>
  <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id631623365667011">If you plan to run scripts from inside the LibreOffice process, it is recommended to install the <a target="_blank" href="https://extensions.libreoffice.org/en/extensions/show/apso-alternative-script-organizer-for-python">APSO (Alternative Script Organizer for Python) extension</a>. However, to develop Python scripts from outside LibreOffice, you can choose your preferred Python IDE.</p></div>
</div>
<br>

  <h2 id="hd_id431623365836802">Running Scripts from inside the LibreOffice process</h2>
  <h3 id="hd_id111623365861568">Using the APSO extension</h3>
  <p id="par_id681623365892513" class="paragraph">The easiest way to get started with Python scripting in LibreOffice is by installing the APSO extension. After installing it, open any LibreOffice component and go to <span class="menuitem">Tools - Macros - Organize Python Scripts</span>.</p>
  <p id="par_id111623366334727" class="paragraph">In APSO's main window go to <span class="menuitem">Menu - Python Shell</span>.</p>
  <div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="tip" title="tip" style="width:40px;height:40px;"></div>
<div class="notetext"><p id="par_id931623366329927">Alternatively you can open APSO using the default shortcut <span class="keycode">Alt + Shift + F11</span>.</p></div>
</div>
<br>
  <p id="par_id661623366478092" class="paragraph">Now you can start typing Python commands and the shell will print the corresponding output after each line of code is executed.</p>
  <p id="par_id581623366559478" class="paragraph">To start using the <span class="literal">ScriptForge</span> library, you need to import the <span class="literal">CreateScriptService</span> method, with which you will be able to access the services provided by the library. The example below uses the <span class="literal">Basic</span> service to display a message box.</p>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
    from scriptforge import CreateScriptService
    bas = CreateScriptService("Basic")
    bas.MsgBox("Hello!")
  </code></pre></div>
  <p id="par_id701623366829587" class="paragraph">To run the example above, enter each line in the Python shell, one by one, pressing the Enter key after you type each line of code.</p>
  <p id="par_id471623366906045" class="paragraph">Now you can start executing Python commands using any of the ScriptForge services. For example, the code snippet below uses the <span class="literal">UI</span> service to create a blank Writer document.</p>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
    ui = CreateScriptService("UI")
    doc = ui.CreateDocument("Writer")
  </code></pre></div>

  <h3 id="hd_id961623367376768">Creating Python script files</h3>
  <p id="par_id821623367433650" class="paragraph">You can create your own Python files and edit them with your preferred text editor. Later you can call them from within any LibreOffice component.</p>
  <p id="par_id51623367560321" class="paragraph">The first step is to locate where your user scripts are stored. For that, refer to <a target="_top" href="en-US/text/sbasic/python/python_locations.html">Python Scripts Organization and Location</a> help page.</p>
  <p id="par_id821623367773032" class="paragraph">Now you can create a text file inside your Python user scripts folder, for instance <span class="emph">sf_test.py</span>, and start typing your scripts.</p>
  <p id="par_id271623367917630" class="paragraph">Next is a simple example that gets the numeric value from a Calc cell and increments it by 1. Simply type the following code into the <span class="emph">sf_test.py</span> file.</p>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
    from scriptforge import CreateScriptService
    doc = CreateScriptService("Calc")
    
    def increment_cell(args=None):
        value = doc.GetValue("A1")
        value += 1
        doc.SetValue("A1", value)
    
    g_exportedScripts = (increment_cell, )
  </code></pre></div>
  <p id="par_id171623368511426" class="paragraph">This example creates the <span class="literal">increment_cell</span> function. Note that <span class="literal">g_exportedScripts</span> is a tuple that tells which functions will be displayed in LibreOffice as user scripts.</p>
  <p id="par_id471623368615244" class="paragraph">To run this script from within a Calc document:</p>
  <ol itemprop="HowTo" itemscope="true" itemtype="http://schema.org/HowToSection">
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
        <p id="par_id811623368677444" class="listitem">Create or open a Calc file.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
        <p id="par_id281623368679141" class="listitem">Enter some numeric value into cell "A1" in the current sheet.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
        <p id="par_id111623368679893" class="listitem">Go to <span class="menuitem">Tools - Macros - Run Macros</span> .</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
        <p id="par_id421623368680565" class="listitem">Choose My Macros - sf_test in the library selector. Then choose the <span class="literal">increment_cell</span> function under the <span class="menuitem">Macro Name</span> list.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
        <p id="par_id131623368875763" class="listitem">Click <span class="emph">Run</span>. Note that the value in cell "A1" was incremented by 1.</p>
    </li>
  </ol>
  <p id="par_id781623368934689" class="paragraph">You can also use APSO to run Python scripts in a similar manner:</p>
  <ol itemprop="HowTo" itemscope="true" itemtype="http://schema.org/HowToSection">
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
        <p id="par_id501623369002537" class="listitem">First open APSO by going to <span class="menuitem">Tools - Macros - Organize Python Scripts</span>.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
        <p id="par_id521623369004825" class="listitem">In the macro list, navigate to <span class="menuitem">My Macros - sf_test - increment_cell</span>.</p>
    </li>
    <li itemprop="itemListElement" itemscope="true" itemtype="http://schema.org/HowToStep">
        <p id="par_id101623369005929" class="listitem">Click <span class="menuitem">Execute</span>.</p>
    </li>
  </ol>

  <h2 id="hd_id531623369208159">Running Scripts separately from the LibreOffice process</h2>
  <a name="InstallPath"></a>
  <h3 id="hd_id261623370168228">Determining the Installation Path</h3>
  <p id="par_id261623369722023" class="paragraph">The first step to run scripts from a separate process is to find the folder where LibreOffice is installed. There are several ways to do that, but <span class="literal">ScriptForge</span> provides a quick way to identify your installation path. For that, open APSO's Python shell and type:</p>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
    from scriptforge import CreateScriptService
    fs = CreateScriptService("FileSystem")
    fs.FileNaming = "SYS"
    inst_dir = fs.InstallFolder
    print(inst_dir)
  </code></pre></div>
  <p id="par_id81623370150730" class="paragraph">The output from the code above is the base directory where LibreOffice is installed. Now you need to add the "program" subfolder to the resulting path. This is the base folder from which you will run Python scripts from a separate process.</p>
  <p id="par_id451623370201479" class="paragraph">For example, suppose you get <span class="emph">/usr/lib/libreoffice/</span> as the result from running the Python code above. Then you need to consider <span class="emph">/usr/lib/libreoffice/program</span> as the path to run your Python scripts.</p>
  

  <h3 id="hd_id231623370501084">Start LibreOffice with socket settings</h3>
  <p id="par_id721623369245475" class="paragraph">To run Python scripts from a separate process, you need to start LibreOffice with a few additional options that specify the hostname and port through which the external process will communicate with the LibreOffice component process.</p>
  <p id="par_id221623369584132" class="paragraph">Open the your operating system's command prompt, navigate to the program folder of your LibreOffice installation directory and type:</p>
  <p id="par_id381623369456352" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">./soffice --accept='socket,host=localhost,port=2021;urp;'</span></p>
  <p id="par_id981623370706743" class="paragraph">The command above will start LibreOffice with a communication channel open so that other processes can exchange messages with it.</p>
  <p id="par_id621623370871360" class="paragraph">Note that the previous example opens LibreOffice start center. If you want to open a specific component, for instance Writer, you can add the --writer flag to the command, as follows.</p>
  <p id="par_id371623370974348" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">./soffice --writer --accept='socket,host=localhost,port=2021;urp;'</span></p>
  <p id="par_id431623373618951" class="paragraph">Take note of the <span class="literal">host</span> and <span class="literal">port</span> parameters, which in this example are <span class="emph">localhost</span> and <span class="emph">2021</span>, respectively.</p>

  <h3 id="hd_id861623370468356">Running an External Python Shell</h3>
  <p id="par_id621623371253647" class="paragraph">Start the Python shell from within the <span class="emph">program</span> folder inside your LibreOffice installation path. Follow the steps <a target="_top" href="en-US/text/sbasic/shared/03/sf_intro.html#InstallPath">above</a> to learn how to find your installation path.</p>
  <p id="par_id11623373098602" class="paragraph"><span class="emph">On Linux / Mac OS:</span></p>
  <p id="par_id601623372243559" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">$ cd /usr/lib/libreoffice/program</span></p>
  <p id="par_id601623372243336" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">$ python</span></p>
  <p id="par_id311623373151552" class="paragraph"><span class="emph">On Windows:</span></p>
  <p id="par_id601623372243204" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">$ cd C:\Program Files\LibreOffice\program\</span></p>
  <p id="par_id601623372243399" class="paragraph"><span class="input" data-tooltip="Click on text to copy to clipboard">$ python.exe</span></p>
  <p id="par_id791623373520018" class="paragraph">This will open the Python shell and now you can start typing commands that will be executed by LibreOffice. But first you need to set up the socket connection.</p>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
    from scriptforge import ScriptForge, CreateScriptService
    ScriptForge(hostname='localhost', port=2021)
  </code></pre></div>
  <p id="par_id351623373686414" class="paragraph">The second line of code above defines the <span class="literal">host</span> and <span class="literal">port</span> settings so that the Python shell can communicate with an ongoing LibreOffice process opened with the same socket settings.</p>
  <p id="par_id721623373769471" class="paragraph">Now you can run other Python commands and they will be able to communicate with the LibreOffice process. For example:</p>
  <div class="pycode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-python line-numbers">
    ui = CreateScriptService("UI")
    bas = CreateScriptService("Basic")
    doc = ui.OpenDocument("~/Documents/myFile.ods")
    bas.MsgBox(doc.DocumentType)
  </code></pre></div>

  <a name="relatedtopics"></a><div class="relatedtopics">
<p class="related" itemprop="mentions"><a name="related"></a><span class="emph">Related Topics</span>
</p>
<div class="relatedbody" itemprop="mentions">
    <div class="embedded"><p class="embedded"><a name="ScriptForge_lib"></a><a target="_top" href="en-US/text/sbasic/shared/03/lib_ScriptForge.html">The <span class="literal">ScriptForge</span> Library</a></p></div>
    <div class="embedded"><p class="embedded"><a name="pythonscriptshelp"></a><a target="_top" href="en-US/text/sbasic/python/main0000.html">LibreOffice Python Scripts Help</a></p></div>
    <div class="embedded"><p class="embedded"><a name="Title_h1"></a><a target="_top" href="en-US/text/shared/guide/start_parameters.html">Starting LibreOffice Software With Parameters</a></p></div>
  </div>
</div>
  </div>
<div id="SearchFrame"></div>
<div id="DonationFrame"></div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/shared/03/sf_intro.xhp" target="_blank">/text/sbasic/shared/03/sf_intro.xhp</a></p>
<p>Title is: Creating Python Scripts with ScriptForge</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
<p id="bm_HID"></p>
</div></footer>
</body>
</html>
